var $s=Object.create;var _r=Object.defineProperty;var Es=Object.getOwnPropertyDescriptor;var Cs=Object.getOwnPropertyNames;var Rs=Object.getPrototypeOf,Is=Object.prototype.hasOwnProperty;var Ls=(r,e,t)=>e in r?_r(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var xr=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Ds=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Cs(e))!Is.call(r,n)&&n!==t&&_r(r,n,{get:()=>e[n],enumerable:!(s=Es(e,n))||s.enumerable});return r};var Ns=(r,e,t)=>(t=r!=null?$s(Rs(r)):{},Ds(e||!r||!r.__esModule?_r(t,"default",{value:r,enumerable:!0}):t,r));var se=(r,e,t)=>Ls(r,typeof e!="symbol"?e+"":e,t);var vn=xr((fo,xn)=>{var kt=1e3,_t=kt*60,xt=_t*60,at=xt*24,zs=at*7,Bs=at*365.25;xn.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return Hs(r);if(t==="number"&&isFinite(r))return e.long?qs(r):Us(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function Hs(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),s=(e[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return t*Bs;case"weeks":case"week":case"w":return t*zs;case"days":case"day":case"d":return t*at;case"hours":case"hour":case"hrs":case"hr":case"h":return t*xt;case"minutes":case"minute":case"mins":case"min":case"m":return t*_t;case"seconds":case"second":case"secs":case"sec":case"s":return t*kt;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Us(r){var e=Math.abs(r);return e>=at?Math.round(r/at)+"d":e>=xt?Math.round(r/xt)+"h":e>=_t?Math.round(r/_t)+"m":e>=kt?Math.round(r/kt)+"s":r+"ms"}function qs(r){var e=Math.abs(r);return e>=at?Jt(r,e,at,"day"):e>=xt?Jt(r,e,xt,"hour"):e>=_t?Jt(r,e,_t,"minute"):e>=kt?Jt(r,e,kt,"second"):r+" ms"}function Jt(r,e,t,s){var n=e>=t*1.5;return Math.round(r/t)+" "+s+(n?"s":"")}});var Sn=xr((ho,An)=>{function js(r){t.debug=t,t.default=t,t.coerce=a,t.disable=o,t.enable=n,t.enabled=l,t.humanize=vn(),t.destroy=f,Object.keys(r).forEach(u=>{t[u]=r[u]}),t.names=[],t.skips=[],t.formatters={};function e(u){let p=0;for(let h=0;h<u.length;h++)p=(p<<5)-p+u.charCodeAt(h),p|=0;return t.colors[Math.abs(p)%t.colors.length]}t.selectColor=e;function t(u){let p,h=null,m,w;function y(...E){if(!y.enabled)return;let _=y,P=Number(new Date),I=P-(p||P);_.diff=I,_.prev=p,_.curr=P,p=P,E[0]=t.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let C=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(K,N)=>{if(K==="%%")return"%";C++;let k=t.formatters[N];if(typeof k=="function"){let $=E[C];K=k.call(_,$),E.splice(C,1),C--}return K}),t.formatArgs.call(_,E),(_.log||t.log).apply(_,E)}return y.namespace=u,y.useColors=t.useColors(),y.color=t.selectColor(u),y.extend=s,y.destroy=t.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(m!==t.namespaces&&(m=t.namespaces,w=t.enabled(u)),w),set:E=>{h=E}}),typeof t.init=="function"&&t.init(y),y}function s(u,p){let h=t(this.namespace+(typeof p>"u"?":":p)+u);return h.log=this.log,h}function n(u){t.save(u),t.namespaces=u,t.names=[],t.skips=[];let p=(typeof u=="string"?u:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let h of p)h[0]==="-"?t.skips.push(h.slice(1)):t.names.push(h)}function i(u,p){let h=0,m=0,w=-1,y=0;for(;h<u.length;)if(m<p.length&&(p[m]===u[h]||p[m]==="*"))p[m]==="*"?(w=m,y=h,m++):(h++,m++);else if(w!==-1)m=w+1,y++,h=y;else return!1;for(;m<p.length&&p[m]==="*";)m++;return m===p.length}function o(){let u=[...t.names,...t.skips.map(p=>"-"+p)].join(",");return t.enable(""),u}function l(u){for(let p of t.skips)if(i(u,p))return!1;for(let p of t.names)if(i(u,p))return!0;return!1}function a(u){return u instanceof Error?u.stack||u.message:u}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}An.exports=js});var Tn=xr((Re,er)=>{Re.formatArgs=Ws;Re.save=Ks;Re.load=Vs;Re.useColors=Gs;Re.storage=Zs();Re.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Re.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Gs(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let r;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(r=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(r[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Ws(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+er.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,s=0;r[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(t++,n==="%c"&&(s=t))}),r.splice(s,0,e)}Re.log=console.debug||console.log||(()=>{});function Ks(r){try{r?Re.storage.setItem("debug",r):Re.storage.removeItem("debug")}catch{}}function Vs(){let r;try{r=Re.storage.getItem("debug")||Re.storage.getItem("DEBUG")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function Zs(){try{return localStorage}catch{}}er.exports=Sn()(Re);var{formatters:Ys}=er.exports;Ys.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var $t=globalThis,Qt=$t.trustedTypes,pn=Qt?Qt.createPolicy("lit-html",{createHTML:r=>r}):void 0,yn="$lit$",Ve=`lit$${Math.random().toFixed(9).slice(2)}$`,wn="?"+Ve,Ms=`<${wn}>`,it=document,Et=()=>it.createComment(""),Ct=r=>r===null||typeof r!="object"&&typeof r!="function",Cr=Array.isArray,Os=r=>Cr(r)||typeof r?.[Symbol.iterator]=="function",vr=`[ 	
\f\r]`,Tt=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,fn=/-->/g,hn=/>/g,nt=RegExp(`>|${vr}(?:([^\\s"'>=/]+)(${vr}*=${vr}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),gn=/'/g,mn=/"/g,kn=/^(?:script|style|textarea|title)$/i,Rr=r=>(e,...t)=>({_$litType$:r,strings:e,values:t}),R=Rr(1),oo=Rr(2),ao=Rr(3),ot=Symbol.for("lit-noChange"),le=Symbol.for("lit-nothing"),bn=new WeakMap,st=it.createTreeWalker(it,129);function _n(r,e){if(!Cr(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return pn!==void 0?pn.createHTML(e):e}var Ps=(r,e)=>{let t=r.length-1,s=[],n,i=e===2?"<svg>":e===3?"<math>":"",o=Tt;for(let l=0;l<t;l++){let a=r[l],f,u,p=-1,h=0;for(;h<a.length&&(o.lastIndex=h,u=o.exec(a),u!==null);)h=o.lastIndex,o===Tt?u[1]==="!--"?o=fn:u[1]!==void 0?o=hn:u[2]!==void 0?(kn.test(u[2])&&(n=RegExp("</"+u[2],"g")),o=nt):u[3]!==void 0&&(o=nt):o===nt?u[0]===">"?(o=n??Tt,p=-1):u[1]===void 0?p=-2:(p=o.lastIndex-u[2].length,f=u[1],o=u[3]===void 0?nt:u[3]==='"'?mn:gn):o===mn||o===gn?o=nt:o===fn||o===hn?o=Tt:(o=nt,n=void 0);let m=o===nt&&r[l+1].startsWith("/>")?" ":"";i+=o===Tt?a+Ms:p>=0?(s.push(f),a.slice(0,p)+yn+a.slice(p)+Ve+m):a+Ve+(p===-2?l:m)}return[_n(r,i+(r[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),s]},Rt=class r{constructor({strings:e,_$litType$:t},s){let n;this.parts=[];let i=0,o=0,l=e.length-1,a=this.parts,[f,u]=Ps(e,t);if(this.el=r.createElement(f,s),st.currentNode=this.el.content,t===2||t===3){let p=this.el.content.firstChild;p.replaceWith(...p.childNodes)}for(;(n=st.nextNode())!==null&&a.length<l;){if(n.nodeType===1){if(n.hasAttributes())for(let p of n.getAttributeNames())if(p.endsWith(yn)){let h=u[o++],m=n.getAttribute(p).split(Ve),w=/([.?@])?(.*)/.exec(h);a.push({type:1,index:i,name:w[2],strings:m,ctor:w[1]==="."?Sr:w[1]==="?"?Tr:w[1]==="@"?$r:yt}),n.removeAttribute(p)}else p.startsWith(Ve)&&(a.push({type:6,index:i}),n.removeAttribute(p));if(kn.test(n.tagName)){let p=n.textContent.split(Ve),h=p.length-1;if(h>0){n.textContent=Qt?Qt.emptyScript:"";for(let m=0;m<h;m++)n.append(p[m],Et()),st.nextNode(),a.push({type:2,index:++i});n.append(p[h],Et())}}}else if(n.nodeType===8)if(n.data===wn)a.push({type:2,index:i});else{let p=-1;for(;(p=n.data.indexOf(Ve,p+1))!==-1;)a.push({type:7,index:i}),p+=Ve.length-1}i++}}static createElement(e,t){let s=it.createElement("template");return s.innerHTML=e,s}};function bt(r,e,t=r,s){if(e===ot)return e;let n=s!==void 0?t._$Co?.[s]:t._$Cl,i=Ct(e)?void 0:e._$litDirective$;return n?.constructor!==i&&(n?._$AO?.(!1),i===void 0?n=void 0:(n=new i(r),n._$AT(r,t,s)),s!==void 0?(t._$Co??(t._$Co=[]))[s]=n:t._$Cl=n),n!==void 0&&(e=bt(r,n._$AS(r,e.values),n,s)),e}var Ar=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){let{el:{content:t},parts:s}=this._$AD,n=(e?.creationScope??it).importNode(t,!0);st.currentNode=n;let i=st.nextNode(),o=0,l=0,a=s[0];for(;a!==void 0;){if(o===a.index){let f;a.type===2?f=new It(i,i.nextSibling,this,e):a.type===1?f=new a.ctor(i,a.name,a.strings,this,e):a.type===6&&(f=new Er(i,this,e)),this._$AV.push(f),a=s[++l]}o!==a?.index&&(i=st.nextNode(),o++)}return st.currentNode=it,n}p(e){let t=0;for(let s of this._$AV)s!==void 0&&(s.strings!==void 0?(s._$AI(e,s,t),t+=s.strings.length-2):s._$AI(e[t])),t++}},It=class r{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,s,n){this.type=2,this._$AH=le,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=s,this.options=n,this._$Cv=n?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode,t=this._$AM;return t!==void 0&&e?.nodeType===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=bt(this,e,t),Ct(e)?e===le||e==null||e===""?(this._$AH!==le&&this._$AR(),this._$AH=le):e!==this._$AH&&e!==ot&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Os(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==le&&Ct(this._$AH)?this._$AA.nextSibling.data=e:this.T(it.createTextNode(e)),this._$AH=e}$(e){let{values:t,_$litType$:s}=e,n=typeof s=="number"?this._$AC(e):(s.el===void 0&&(s.el=Rt.createElement(_n(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===n)this._$AH.p(t);else{let i=new Ar(n,this),o=i.u(this.options);i.p(t),this.T(o),this._$AH=i}}_$AC(e){let t=bn.get(e.strings);return t===void 0&&bn.set(e.strings,t=new Rt(e)),t}k(e){Cr(this._$AH)||(this._$AH=[],this._$AR());let t=this._$AH,s,n=0;for(let i of e)n===t.length?t.push(s=new r(this.O(Et()),this.O(Et()),this,this.options)):s=t[n],s._$AI(i),n++;n<t.length&&(this._$AR(s&&s._$AB.nextSibling,n),t.length=n)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e!==this._$AB;){let s=e.nextSibling;e.remove(),e=s}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},yt=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,s,n,i){this.type=1,this._$AH=le,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=i,s.length>2||s[0]!==""||s[1]!==""?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=le}_$AI(e,t=this,s,n){let i=this.strings,o=!1;if(i===void 0)e=bt(this,e,t,0),o=!Ct(e)||e!==this._$AH&&e!==ot,o&&(this._$AH=e);else{let l=e,a,f;for(e=i[0],a=0;a<i.length-1;a++)f=bt(this,l[s+a],t,a),f===ot&&(f=this._$AH[a]),o||(o=!Ct(f)||f!==this._$AH[a]),f===le?e=le:e!==le&&(e+=(f??"")+i[a+1]),this._$AH[a]=f}o&&!n&&this.j(e)}j(e){e===le?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},Sr=class extends yt{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===le?void 0:e}},Tr=class extends yt{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==le)}},$r=class extends yt{constructor(e,t,s,n,i){super(e,t,s,n,i),this.type=5}_$AI(e,t=this){if((e=bt(this,e,t,0)??le)===ot)return;let s=this._$AH,n=e===le&&s!==le||e.capture!==s.capture||e.once!==s.once||e.passive!==s.passive,i=e!==le&&(s===le||n);n&&this.element.removeEventListener(this.name,this,s),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},Er=class{constructor(e,t,s){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(e){bt(this,e)}};var Fs=$t.litHtmlPolyfillSupport;Fs?.(Rt,It),($t.litHtmlVersions??($t.litHtmlVersions=[])).push("3.3.1");var Ce=(r,e,t)=>{let s=t?.renderBefore??e,n=s._$litPart$;if(n===void 0){let i=t?.renderBefore??null;s._$litPart$=n=new It(e.insertBefore(Et(),i),i,void 0,t??{})}return n._$AI(r),n};function Ne(r,e){let t=r.priority??2,s=e.priority??2;if(t!==s)return t-s;let n=r.created_at??0,i=e.created_at??0;if(n!==i)return n<i?-1:1;let o=r.id,l=e.id;return o<l?-1:o>l?1:0}function wt(r,e){let t=r.closed_at??0,s=e.closed_at??0;if(t!==s)return t<s?1:-1;let n=r?.id,i=e?.id;return n<i?-1:n>i?1:0}function Ze(r=void 0){function e(i){return!r||typeof r.snapshotFor!="function"?[]:r.snapshotFor(i).slice().sort(Ne)}function t(i,o){let l=r&&r.snapshotFor?r.snapshotFor(i).slice():[];return o==="in_progress"?l.sort(Ne):o==="closed"?l.sort(wt):l.sort(Ne),l}function s(i){if(!r||typeof r.snapshotFor!="function")return[];let l=(r.snapshotFor(`detail:${i}`)||[]).find(f=>String(f?.id||"")===String(i));return(Array.isArray(l?.dependents)?l.dependents:[]).slice().sort(Ne)}function n(i){return r&&typeof r.subscribe=="function"?r.subscribe(i):()=>{}}return{selectIssuesFor:e,selectBoardColumn:t,selectEpicChildren:s,subscribe:n}}var $n=Ns(Tn(),1);function ae(r){return(0,$n.default)(`beads-ui:${r}`)}function En(r){let e=ae("data");async function t(s){let{id:n}=s;e("updateIssue %s %o",n,Object.keys(s));let i=null;return typeof s.title=="string"&&(i=await r("edit-text",{id:n,field:"title",value:s.title})),typeof s.acceptance=="string"&&(i=await r("edit-text",{id:n,field:"acceptance",value:s.acceptance})),typeof s.notes=="string"&&(i=await r("edit-text",{id:n,field:"notes",value:s.notes})),typeof s.design=="string"&&(i=await r("edit-text",{id:n,field:"design",value:s.design})),typeof s.status=="string"&&(i=await r("update-status",{id:n,status:s.status})),typeof s.priority=="number"&&(i=await r("update-priority",{id:n,priority:s.priority})),typeof s.assignee=="string"&&(i=await r("update-assignee",{id:n,assignee:s.assignee})),e("updateIssue done %s",n),i}return{updateIssue:t}}function Ir(r,e={}){let t=ae(`issue-store:${r}`),s=new Map,n=[],i=0,o=new Set,l=!1,a=e.sort||Ne;function f(){for(let h of Array.from(o))try{h()}catch{}}function u(){n=Array.from(s.values()).sort(a)}function p(h){if(l||!h||h.id!==r)return;let m=Number(h.revision)||0;if(t("apply %s rev=%d",h.type,m),!(m<=i&&h.type!=="snapshot")){if(h.type==="snapshot"){if(m<=i)return;s.clear();let w=Array.isArray(h.issues)?h.issues:[];for(let y of w)y&&typeof y.id=="string"&&y.id.length>0&&s.set(y.id,y);u(),i=m,f();return}if(h.type==="upsert"){let w=h.issue;if(w&&typeof w.id=="string"&&w.id.length>0){let y=s.get(w.id);if(!y)s.set(w.id,w);else{let E=Number.isFinite(y.updated_at)?y.updated_at:0,_=Number.isFinite(w.updated_at)?w.updated_at:0;if(E<=_){for(let P of Object.keys(y))P in w||delete y[P];for(let[P,I]of Object.entries(w))y[P]=I}}u()}i=m,f()}else if(h.type==="delete"){let w=String(h.issue_id||"");w&&(s.delete(w),u()),i=m,f()}}}return{id:r,subscribe(h){return o.add(h),()=>{o.delete(h)}},applyPush:p,snapshot(){return n},size(){return s.size},getById(h){return s.get(h)},dispose(){l=!0,s.clear(),n=[],o.clear(),i=0}}}function tr(r){let e=String(r.type||"").trim(),t={};if(r.params&&typeof r.params=="object"){let n=Object.keys(r.params).sort();for(let i of n){let o=r.params[i];t[i]=String(o)}}let s=new URLSearchParams(t).toString();return s.length>0?`${e}?${s}`:e}function Cn(r){let e=ae("subs"),t=new Map,s=new Map;function n(l,a){e("applyDelta %s +%d ~%d -%d",l,(a.added||[]).length,(a.updated||[]).length,(a.removed||[]).length);let f=s.get(l);if(!f||f.size===0)return;let u=Array.isArray(a.added)?a.added:[],p=Array.isArray(a.updated)?a.updated:[],h=Array.isArray(a.removed)?a.removed:[];for(let m of Array.from(f)){let w=t.get(m);if(!w)continue;let y=w.itemsById;for(let E of u)typeof E=="string"&&E.length>0&&y.set(E,!0);for(let E of p)typeof E=="string"&&E.length>0&&y.set(E,!0);for(let E of h)typeof E=="string"&&E.length>0&&y.delete(E)}}async function i(l,a){let f=tr(a);if(e("subscribe %s key=%s",l,f),!t.has(l))t.set(l,{key:f,itemsById:new Map});else{let p=t.get(l);if(p&&p.key!==f){let h=s.get(p.key);h&&(h.delete(l),h.size===0&&s.delete(p.key)),t.set(l,{key:f,itemsById:new Map})}}s.has(f)||s.set(f,new Set);let u=s.get(f);u&&u.add(l);try{await r("subscribe-list",{id:l,type:a.type,params:a.params})}catch(p){let h=t.get(l)||null;if(h){let m=s.get(h.key);m&&(m.delete(l),m.size===0&&s.delete(h.key))}throw t.delete(l),p}return async()=>{e("unsubscribe %s key=%s",l,f);try{await r("unsubscribe-list",{id:l})}catch{}let p=t.get(l)||null;if(p){let h=s.get(p.key);h&&(h.delete(l),h.size===0&&s.delete(p.key))}t.delete(l)}}return{subscribeList:i,_applyDelta:n,_subKeyOf:tr,selectors:{getIds(l){let a=t.get(l);return a?Array.from(a.itemsById.keys()):[]},has(l,a){let f=t.get(l);return f?f.itemsById.has(a):!1},count(l){let a=t.get(l);return a?a.itemsById.size:0},getItemsById(l){let a=t.get(l),f={};if(!a)return f;for(let u of a.itemsById.keys())f[u]=!0;return f}}}}function Rn(){let r=ae("issue-stores"),e=new Map,t=new Map,s=new Set,n=new Map;function i(){for(let a of Array.from(s))try{a()}catch{}}function o(a,f,u){let p=f?tr(f):"",h=t.get(a)||"",m=e.has(a);if(r("register %s key=%s (prev=%s)",a,p,h),m&&h&&p&&h!==p){let w=e.get(a);if(w)try{w.dispose()}catch{}let y=n.get(a);if(y){try{y()}catch{}n.delete(a)}let E=Ir(a,u);e.set(a,E);let _=E.subscribe(()=>i());n.set(a,_)}else if(!m){let w=Ir(a,u);e.set(a,w);let y=w.subscribe(()=>i());n.set(a,y)}return t.set(a,p),()=>l(a)}function l(a){r("unregister %s",a),t.delete(a);let f=e.get(a);f&&(f.dispose(),e.delete(a));let u=n.get(a);if(u){try{u()}catch{}n.delete(a)}}return{register:o,unregister:l,getStore(a){return e.get(a)||null},snapshotFor(a){let f=e.get(a);return f?f.snapshot().slice():[]},subscribe(a){return s.add(a),()=>s.delete(a)}}}function Ye(r,e){return`#/${r==="epics"||r==="board"?r:"issues"}?issue=${encodeURIComponent(e)}`}function rr(r){let e=String(r||""),t=e.startsWith("#")?e.slice(1):e,s=t.indexOf("?"),n=s>=0?t.slice(s+1):"";if(n){let l=new URLSearchParams(n).get("issue");if(l)return decodeURIComponent(l)}let i=/^\/issue\/([^\s?#]+)/.exec(t);return i&&i[1]?decodeURIComponent(i[1]):null}function vt(r){let e=String(r||"");return/^#\/epics(\b|\/|$)/.test(e)?"epics":/^#\/board(\b|\/|$)/.test(e)?"board":"issues"}function In(r){let e=ae("router"),t=()=>{let s=window.location.hash||"",n=/^#\/issue\/([^\s?#]+)/.exec(s);if(n&&n[1]){let l=decodeURIComponent(n[1]);r.setState({selected_id:l,view:"issues"});let a=`#/issues?issue=${encodeURIComponent(l)}`;if(window.location.hash!==a){window.location.hash=a;return}}let i=rr(s),o=vt(s);e("hash change \u2192 view=%s id=%s",o,i),r.setState({selected_id:i,view:o})};return{start(){window.addEventListener("hashchange",t),t()},stop(){window.removeEventListener("hashchange",t)},gotoIssue(s){let i=(r.getState?r.getState():{view:"issues"}).view||"issues",o=Ye(i,s);e("goto issue %s (view=%s)",s,i),window.location.hash!==o?window.location.hash=o:r.setState({selected_id:s,view:i})},gotoView(s){let i=(r.getState?r.getState():{selected_id:null}).selected_id,o=i?Ye(s,i):`#/${s}`;e("goto view %s (id=%s)",s,i||""),window.location.hash!==o?window.location.hash=o:r.setState({view:s,selected_id:null})}}}function Ln(r={}){let e=ae("state"),t={selected_id:r.selected_id??null,view:r.view??"issues",filters:{status:r.filters?.status??"all",search:r.filters?.search??"",type:typeof r.filters?.type=="string"?r.filters?.type:""},board:{closed_filter:r.board?.closed_filter==="3"||r.board?.closed_filter==="7"||r.board?.closed_filter==="today"?r.board?.closed_filter:"today"}},s=new Set;function n(){for(let i of Array.from(s))try{i(t)}catch{}}return{getState(){return t},setState(i){let o={...t,...i,filters:{...t.filters,...i.filters||{}},board:{...t.board,...i.board||{}}};o.selected_id===t.selected_id&&o.view===t.view&&o.filters.status===t.filters.status&&o.filters.search===t.filters.search&&o.filters.type===t.filters.type&&o.board.closed_filter===t.board.closed_filter||(t=o,e("state change %o",{selected_id:t.selected_id,view:t.view,filters:t.filters,board:t.board}),n())},subscribe(i){return s.add(i),()=>s.delete(i)}}}function Dn(r){let e=0;function t(){if(!r)return;let o=e>0;r.toggleAttribute("hidden",!o),r.setAttribute("aria-busy",o?"true":"false")}function s(){e+=1,t()}function n(){e=Math.max(0,e-1),t()}function i(o){return async(l,a)=>{s();try{return await o(l,a)}finally{n()}}}return t(),{wrapSend:i,start:s,done:n,getCount:()=>e}}function he(r,e="info",t=2800){let s=document.createElement("div");s.className="toast",s.textContent=r,s.style.position="fixed",s.style.right="12px",s.style.bottom="12px",s.style.zIndex="1000",s.style.color="#fff",s.style.padding="8px 10px",s.style.borderRadius="4px",s.style.fontSize="12px",e==="success"?s.style.background="#156d36":e==="error"?s.style.background="#9f2011":s.style.background="rgba(0,0,0,0.85)",(document.body||document.documentElement).appendChild(s),setTimeout(()=>{try{s.remove()}catch{}},t)}function Xe(r,e){let t=typeof e?.duration_ms=="number"?e.duration_ms:1200,s=document.createElement("button");s.className=(e?.class_name?e.class_name+" ":"")+"mono id-copy",s.type="button",s.setAttribute("aria-live","polite"),s.setAttribute("title","Copy issue ID"),s.setAttribute("aria-label",`Copy issue ID ${r}`),s.textContent=r;async function n(){try{navigator.clipboard&&typeof navigator.clipboard.writeText=="function"&&await navigator.clipboard.writeText(String(r)),s.textContent="Copied";let i=s.getAttribute("aria-label")||"";s.setAttribute("aria-label","Copied"),setTimeout(()=>{s.textContent=r,s.setAttribute("aria-label",i)},Math.max(80,t))}catch{}}return s.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),n()}),s.addEventListener("keydown",i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),i.stopPropagation(),n())}),s}var Qe=["Critical","High","Medium","Low","Backlog"];function Nn(r){let e=typeof r=="number"?r:2,t=document.createElement("span");t.className="priority-badge",t.classList.add(`is-p${Math.max(0,Math.min(4,e))}`),t.setAttribute("role","img");let s=Xs(e);return t.setAttribute("title",s),t.setAttribute("aria-label",`Priority: ${s}`),t.textContent=Lt(e)+" "+s,t}function Xs(r){let e=Math.max(0,Math.min(4,r));return Qe[e]||"Medium"}function Lt(r){switch(r){case 0:return"\u{1F525}";case 1:return"\u26A1\uFE0F";case 2:return"\u{1F527}";case 3:return"\u{1FAB6}";case 4:return"\u{1F4A4}";default:return"\u{1F527}"}}function lt(r){let e=document.createElement("span");e.className="type-badge";let t=(r||"").toString().toLowerCase(),s=new Set(["bug","feature","task","epic","chore"]),n=s.has(t)?t:"neutral";e.classList.add(`type-badge--${n}`),e.setAttribute("role","img");let i=s.has(t)?t==="bug"?"Bug":t==="feature"?"Feature":t==="task"?"Task":t==="epic"?"Epic":"Chore":"\u2014";return e.setAttribute("aria-label",s.has(t)?`Issue type: ${i}`:"Issue type: unknown"),e.setAttribute("title",s.has(t)?`Type: ${i}`:"Type: unknown"),e.textContent=i,e}function Mn(r,e,t,s,n=void 0,i=void 0){let o=ae("views:board"),l=[],a=[],f=[],u=[],p=[],h=i?Ze(i):null,m="today";if(s)try{let N=s.getState(),k=N&&N.board?String(N.board.closed_filter||"today"):"today";(k==="today"||k==="3"||k==="7")&&(m=k)}catch{}function w(){return R`
      <div class="panel__body board-root">
        ${y("Blocked","blocked-col",a)}
        ${y("Ready","ready-col",l)}
        ${y("In Progress","in-progress-col",f)}
        ${y("Closed","closed-col",u)}
      </div>
    `}function y(N,k,$){let L=Array.isArray($)?$.length:0,B=L===1?"1 issue":`${L} issues`;return R`
      <section class="board-column" id=${k}>
        <header
          class="board-column__header"
          id=${k+"-header"}
          role="heading"
          aria-level="2"
        >
          <div class="board-column__title">
            <span class="board-column__title-text">${N}</span>
            <span class="badge board-column__count" aria-label=${B}>
              ${L}
            </span>
          </div>
          ${k==="closed-col"?R`<label class="board-closed-filter">
                <span class="visually-hidden">Filter closed issues</span>
                <select
                  id="closed-filter"
                  aria-label="Filter closed issues"
                  @change=${O}
                >
                  <option
                    value="today"
                    ?selected=${m==="today"}
                  >
                    Today
                  </option>
                  <option value="3" ?selected=${m==="3"}>
                    Last 3 days
                  </option>
                  <option value="7" ?selected=${m==="7"}>
                    Last 7 days
                  </option>
                </select>
              </label>`:""}
        </header>
        <div
          class="board-column__body"
          role="list"
          aria-labelledby=${k+"-header"}
        >
          ${$.map(te=>E(te))}
        </div>
      </section>
    `}function E(N){return R`
      <article
        class="board-card"
        data-issue-id=${N.id}
        role="listitem"
        tabindex="-1"
        @click=${()=>t(N.id)}
      >
        <div class="board-card__title text-truncate">
          ${N.title||"(no title)"}
        </div>
        <div class="board-card__meta">
          ${lt(N.issue_type)} ${Nn(N.priority)}
          ${Xe(N.id,{class_name:"mono"})}
        </div>
      </article>
    `}function _(){Ce(w(),r),P()}function P(){try{let N=Array.from(r.querySelectorAll(".board-column"));for(let k of N){let $=k.querySelector(".board-column__body");if(!$)continue;let L=Array.from($.querySelectorAll(".board-card")),B=k.querySelector(".board-column__header"),te=B&&B.textContent?.trim()||"";for(let Y of L){let b=Y.querySelector(".board-card__title"),T=b&&b.textContent?.trim()||"";Y.setAttribute("aria-label",`Issue ${T||"(no title)"} \u2014 Column ${te}`),Y.tabIndex=-1}L.length>0&&(L[0].tabIndex=0)}}catch{}}r.addEventListener("keydown",N=>{let k=N.target;if(!k||!(k instanceof HTMLElement))return;let $=String(k.tagName||"").toLowerCase();if($==="input"||$==="textarea"||$==="select"||k.isContentEditable===!0)return;let L=k.closest(".board-card");if(!L)return;let B=String(N.key||"");if(B==="Enter"||B===" "){N.preventDefault();let F=L.getAttribute("data-issue-id");F&&t(F);return}if(B!=="ArrowUp"&&B!=="ArrowDown"&&B!=="ArrowLeft"&&B!=="ArrowRight")return;N.preventDefault();let te=L.closest(".board-column");if(!te)return;let Y=te.querySelector(".board-column__body");if(!Y)return;let b=Array.from(Y.querySelectorAll(".board-card")),T=b.indexOf(L);if(T!==-1){if(B==="ArrowDown"&&T<b.length-1){I(b[T],b[T+1]);return}if(B==="ArrowUp"&&T>0){I(b[T],b[T-1]);return}if(B==="ArrowRight"||B==="ArrowLeft"){let F=Array.from(r.querySelectorAll(".board-column")),Z=F.indexOf(te);if(Z===-1)return;let U=B==="ArrowRight"?1:-1,J=Z+U,ie=null;for(;J>=0&&J<F.length;){let H=F[J],ge=H.querySelector(".board-column__body");if((ge?Array.from(ge.querySelectorAll(".board-card")):[]).length>0){ie=H;break}J+=U}if(ie){let H=ie.querySelector(".board-column__body .board-card");H&&I(L,H)}return}}});function I(N,k){try{N.tabIndex=-1,k.tabIndex=0,k.focus()}catch{}}function C(){o("applyClosedFilter %s",m);let N=Array.isArray(p)?[...p]:[],k=new Date,$=0;m==="today"?$=new Date(k.getFullYear(),k.getMonth(),k.getDate(),0,0,0,0).getTime():m==="3"?$=k.getTime()-4320*60*1e3:m==="7"&&($=k.getTime()-10080*60*1e3),N=N.filter(L=>{let B=Number.isFinite(L.closed_at)?L.closed_at:NaN;return Number.isFinite(B)?B>=$:!1}),N.sort(wt),u=N}function O(N){try{let k=N.target,$=String(k.value||"today");if(m=$==="3"||$==="7"?$:"today",o("closed filter %s",m),s)try{s.setState({board:{closed_filter:m}})}catch{}C(),_()}catch{}}function K(){try{if(h){let N=h.selectBoardColumn("tab:board:in-progress","in_progress"),k=h.selectBoardColumn("tab:board:blocked","blocked"),$=h.selectBoardColumn("tab:board:ready","ready"),L=h.selectBoardColumn("tab:board:closed","closed"),B=new Set(N.map(Y=>Y.id));l=$.filter(Y=>!B.has(Y.id)),a=k,f=N,p=L}C(),_()}catch{l=[],a=[],f=[],u=[],_()}}return h&&h.subscribe(()=>{try{K()}catch{}}),{async load(){o("load"),K();try{let N=!!(n&&n.selectors),k=te=>{if(!N||!n)return 0;let Y=n.selectors;if(typeof Y.count=="function")return Number(Y.count(te)||0);try{let b=Y.getIds(te);return Array.isArray(b)?b.length:0}catch{return 0}},$=k("tab:board:ready")+k("tab:board:blocked")+k("tab:board:in-progress")+k("tab:board:closed"),L=e,B=L&&typeof L.getReady=="function"&&typeof L.getBlocked=="function"&&typeof L.getInProgress=="function"&&typeof L.getClosed=="function";if($===0&&B){o("fallback fetch");let[te,Y,b,T]=await Promise.all([L.getReady().catch(()=>[]),L.getBlocked().catch(()=>[]),L.getInProgress().catch(()=>[]),L.getClosed().catch(()=>[])]),F=Array.isArray(te)?te.map(H=>H):[],Z=Array.isArray(Y)?Y.map(H=>H):[],U=Array.isArray(b)?b.map(H=>H):[],J=Array.isArray(T)?T.map(H=>H):[],ie=new Set(U.map(H=>H.id));F=F.filter(H=>!ie.has(H.id)),F.sort(Ne),Z.sort(Ne),U.sort(Ne),l=F,a=Z,f=U,p=J,C(),_()}}catch{}},clear(){r.replaceChildren(),l=[],a=[],f=[],u=[]}}}var{entries:jn,setPrototypeOf:On,isFrozen:Qs,getPrototypeOf:Js,getOwnPropertyDescriptor:ei}=Object,{freeze:ve,seal:Le,create:Fr}=Object,{apply:zr,construct:Br}=typeof Reflect<"u"&&Reflect;ve||(ve=function(e){return e});Le||(Le=function(e){return e});zr||(zr=function(e,t){for(var s=arguments.length,n=new Array(s>2?s-2:0),i=2;i<s;i++)n[i-2]=arguments[i];return e.apply(t,n)});Br||(Br=function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];return new e(...s)});var nr=Ae(Array.prototype.forEach),ti=Ae(Array.prototype.lastIndexOf),Pn=Ae(Array.prototype.pop),Dt=Ae(Array.prototype.push),ri=Ae(Array.prototype.splice),ir=Ae(String.prototype.toLowerCase),Lr=Ae(String.prototype.toString),Dr=Ae(String.prototype.match),Nt=Ae(String.prototype.replace),ni=Ae(String.prototype.indexOf),si=Ae(String.prototype.trim),Me=Ae(Object.prototype.hasOwnProperty),xe=Ae(RegExp.prototype.test),Mt=ii(TypeError);function Ae(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];return zr(r,e,s)}}function ii(r){return function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return Br(r,t)}}function V(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ir;On&&On(r,null);let s=e.length;for(;s--;){let n=e[s];if(typeof n=="string"){let i=t(n);i!==n&&(Qs(e)||(e[s]=i),n=i)}r[n]=!0}return r}function oi(r){for(let e=0;e<r.length;e++)Me(r,e)||(r[e]=null);return r}function Ue(r){let e=Fr(null);for(let[t,s]of jn(r))Me(r,t)&&(Array.isArray(s)?e[t]=oi(s):s&&typeof s=="object"&&s.constructor===Object?e[t]=Ue(s):e[t]=s);return e}function Ot(r,e){for(;r!==null;){let s=ei(r,e);if(s){if(s.get)return Ae(s.get);if(typeof s.value=="function")return Ae(s.value)}r=Js(r)}function t(){return null}return t}var Fn=ve(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Nr=ve(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Mr=ve(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ai=ve(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Or=ve(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),li=ve(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),zn=ve(["#text"]),Bn=ve(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Pr=ve(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Hn=ve(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),sr=ve(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ci=Le(/\{\{[\w\W]*|[\w\W]*\}\}/gm),di=Le(/<%[\w\W]*|[\w\W]*%>/gm),ui=Le(/\$\{[\w\W]*/gm),pi=Le(/^data-[\-\w.\u00B7-\uFFFF]+$/),fi=Le(/^aria-[\-\w]+$/),Gn=Le(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),hi=Le(/^(?:\w+script|data):/i),gi=Le(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Wn=Le(/^html$/i),mi=Le(/^[a-z][.\w]*(-[.\w]+)+$/i),Un=Object.freeze({__proto__:null,ARIA_ATTR:fi,ATTR_WHITESPACE:gi,CUSTOM_ELEMENT:mi,DATA_ATTR:pi,DOCTYPE_NAME:Wn,ERB_EXPR:di,IS_ALLOWED_URI:Gn,IS_SCRIPT_OR_DATA:hi,MUSTACHE_EXPR:ci,TMPLIT_EXPR:ui}),Pt={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},bi=function(){return typeof window>"u"?null:window},yi=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let s=null,n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(s=t.getAttribute(n));let i="dompurify"+(s?"#"+s:"");try{return e.createPolicy(i,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},qn=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Kn(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bi(),e=z=>Kn(z);if(e.version="3.3.0",e.removed=[],!r||!r.document||r.document.nodeType!==Pt.document||!r.Element)return e.isSupported=!1,e;let{document:t}=r,s=t,n=s.currentScript,{DocumentFragment:i,HTMLTemplateElement:o,Node:l,Element:a,NodeFilter:f,NamedNodeMap:u=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:p,DOMParser:h,trustedTypes:m}=r,w=a.prototype,y=Ot(w,"cloneNode"),E=Ot(w,"remove"),_=Ot(w,"nextSibling"),P=Ot(w,"childNodes"),I=Ot(w,"parentNode");if(typeof o=="function"){let z=t.createElement("template");z.content&&z.content.ownerDocument&&(t=z.content.ownerDocument)}let C,O="",{implementation:K,createNodeIterator:N,createDocumentFragment:k,getElementsByTagName:$}=t,{importNode:L}=s,B=qn();e.isSupported=typeof jn=="function"&&typeof I=="function"&&K&&K.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:te,ERB_EXPR:Y,TMPLIT_EXPR:b,DATA_ATTR:T,ARIA_ATTR:F,IS_SCRIPT_OR_DATA:Z,ATTR_WHITESPACE:U,CUSTOM_ELEMENT:J}=Un,{IS_ALLOWED_URI:ie}=Un,H=null,ge=V({},[...Fn,...Nr,...Mr,...Or,...zn]),re=null,Te=V({},[...Bn,...Pr,...Hn,...sr]),X=Object.seal(Fr(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ke=null,$e=null,_e=Object.seal(Fr(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}})),De=!0,Ie=!0,je=!1,x=!0,g=!1,j=!0,q=!1,pe=!1,fe=!1,Ge=!1,pt=!1,Je=!1,Wt=!0,At=!1,mr="user-content-",D=!0,et=!1,We={},Ke=null,Kt=V({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Vt=null,Zt=V({},["audio","video","img","source","image","track"]),St=null,d=V({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),S="http://www.w3.org/1998/Math/MathML",G="http://www.w3.org/2000/svg",A="http://www.w3.org/1999/xhtml",ee=A,me=!1,ft=null,be=V({},[S,G,A],Lr),ht=V({},["mi","mo","mn","ms","mtext"]),gt=V({},["annotation-xml"]),br=V({},["title","style","font","a","script"]),ze=null,yr=["application/xhtml+xml","text/html"],Yt="text/html",ce=null,W=null,de=t.createElement("form"),tt=function(c){return c instanceof RegExp||c instanceof Function},Xt=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(W&&W===c)){if((!c||typeof c!="object")&&(c={}),c=Ue(c),ze=yr.indexOf(c.PARSER_MEDIA_TYPE)===-1?Yt:c.PARSER_MEDIA_TYPE,ce=ze==="application/xhtml+xml"?Lr:ir,H=Me(c,"ALLOWED_TAGS")?V({},c.ALLOWED_TAGS,ce):ge,re=Me(c,"ALLOWED_ATTR")?V({},c.ALLOWED_ATTR,ce):Te,ft=Me(c,"ALLOWED_NAMESPACES")?V({},c.ALLOWED_NAMESPACES,Lr):be,St=Me(c,"ADD_URI_SAFE_ATTR")?V(Ue(d),c.ADD_URI_SAFE_ATTR,ce):d,Vt=Me(c,"ADD_DATA_URI_TAGS")?V(Ue(Zt),c.ADD_DATA_URI_TAGS,ce):Zt,Ke=Me(c,"FORBID_CONTENTS")?V({},c.FORBID_CONTENTS,ce):Kt,ke=Me(c,"FORBID_TAGS")?V({},c.FORBID_TAGS,ce):Ue({}),$e=Me(c,"FORBID_ATTR")?V({},c.FORBID_ATTR,ce):Ue({}),We=Me(c,"USE_PROFILES")?c.USE_PROFILES:!1,De=c.ALLOW_ARIA_ATTR!==!1,Ie=c.ALLOW_DATA_ATTR!==!1,je=c.ALLOW_UNKNOWN_PROTOCOLS||!1,x=c.ALLOW_SELF_CLOSE_IN_ATTR!==!1,g=c.SAFE_FOR_TEMPLATES||!1,j=c.SAFE_FOR_XML!==!1,q=c.WHOLE_DOCUMENT||!1,Ge=c.RETURN_DOM||!1,pt=c.RETURN_DOM_FRAGMENT||!1,Je=c.RETURN_TRUSTED_TYPE||!1,fe=c.FORCE_BODY||!1,Wt=c.SANITIZE_DOM!==!1,At=c.SANITIZE_NAMED_PROPS||!1,D=c.KEEP_CONTENT!==!1,et=c.IN_PLACE||!1,ie=c.ALLOWED_URI_REGEXP||Gn,ee=c.NAMESPACE||A,ht=c.MATHML_TEXT_INTEGRATION_POINTS||ht,gt=c.HTML_INTEGRATION_POINTS||gt,X=c.CUSTOM_ELEMENT_HANDLING||{},c.CUSTOM_ELEMENT_HANDLING&&tt(c.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(X.tagNameCheck=c.CUSTOM_ELEMENT_HANDLING.tagNameCheck),c.CUSTOM_ELEMENT_HANDLING&&tt(c.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(X.attributeNameCheck=c.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),c.CUSTOM_ELEMENT_HANDLING&&typeof c.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(X.allowCustomizedBuiltInElements=c.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),g&&(Ie=!1),pt&&(Ge=!0),We&&(H=V({},zn),re=[],We.html===!0&&(V(H,Fn),V(re,Bn)),We.svg===!0&&(V(H,Nr),V(re,Pr),V(re,sr)),We.svgFilters===!0&&(V(H,Mr),V(re,Pr),V(re,sr)),We.mathMl===!0&&(V(H,Or),V(re,Hn),V(re,sr))),c.ADD_TAGS&&(typeof c.ADD_TAGS=="function"?_e.tagCheck=c.ADD_TAGS:(H===ge&&(H=Ue(H)),V(H,c.ADD_TAGS,ce))),c.ADD_ATTR&&(typeof c.ADD_ATTR=="function"?_e.attributeCheck=c.ADD_ATTR:(re===Te&&(re=Ue(re)),V(re,c.ADD_ATTR,ce))),c.ADD_URI_SAFE_ATTR&&V(St,c.ADD_URI_SAFE_ATTR,ce),c.FORBID_CONTENTS&&(Ke===Kt&&(Ke=Ue(Ke)),V(Ke,c.FORBID_CONTENTS,ce)),D&&(H["#text"]=!0),q&&V(H,["html","head","body"]),H.table&&(V(H,["tbody"]),delete ke.tbody),c.TRUSTED_TYPES_POLICY){if(typeof c.TRUSTED_TYPES_POLICY.createHTML!="function")throw Mt('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof c.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Mt('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=c.TRUSTED_TYPES_POLICY,O=C.createHTML("")}else C===void 0&&(C=yi(m,n)),C!==null&&typeof O=="string"&&(O=C.createHTML(""));ve&&ve(c),W=c}},en=V({},[...Nr,...Mr,...ai]),tn=V({},[...Or,...li]),Ss=function(c){let v=I(c);(!v||!v.tagName)&&(v={namespaceURI:ee,tagName:"template"});let M=ir(c.tagName),oe=ir(v.tagName);return ft[c.namespaceURI]?c.namespaceURI===G?v.namespaceURI===A?M==="svg":v.namespaceURI===S?M==="svg"&&(oe==="annotation-xml"||ht[oe]):!!en[M]:c.namespaceURI===S?v.namespaceURI===A?M==="math":v.namespaceURI===G?M==="math"&&gt[oe]:!!tn[M]:c.namespaceURI===A?v.namespaceURI===G&&!gt[oe]||v.namespaceURI===S&&!ht[oe]?!1:!tn[M]&&(br[M]||!en[M]):!!(ze==="application/xhtml+xml"&&ft[c.namespaceURI]):!1},Fe=function(c){Dt(e.removed,{element:c});try{I(c).removeChild(c)}catch{E(c)}},rt=function(c,v){try{Dt(e.removed,{attribute:v.getAttributeNode(c),from:v})}catch{Dt(e.removed,{attribute:null,from:v})}if(v.removeAttribute(c),c==="is")if(Ge||pt)try{Fe(v)}catch{}else try{v.setAttribute(c,"")}catch{}},rn=function(c){let v=null,M=null;if(fe)c="<remove></remove>"+c;else{let ue=Dr(c,/^[\r\n\t ]+/);M=ue&&ue[0]}ze==="application/xhtml+xml"&&ee===A&&(c='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+c+"</body></html>");let oe=C?C.createHTML(c):c;if(ee===A)try{v=new h().parseFromString(oe,ze)}catch{}if(!v||!v.documentElement){v=K.createDocument(ee,"template",null);try{v.documentElement.innerHTML=me?O:oe}catch{}}let we=v.body||v.documentElement;return c&&M&&we.insertBefore(t.createTextNode(M),we.childNodes[0]||null),ee===A?$.call(v,q?"html":"body")[0]:q?v.documentElement:we},nn=function(c){return N.call(c.ownerDocument||c,c,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},wr=function(c){return c instanceof p&&(typeof c.nodeName!="string"||typeof c.textContent!="string"||typeof c.removeChild!="function"||!(c.attributes instanceof u)||typeof c.removeAttribute!="function"||typeof c.setAttribute!="function"||typeof c.namespaceURI!="string"||typeof c.insertBefore!="function"||typeof c.hasChildNodes!="function")},sn=function(c){return typeof l=="function"&&c instanceof l};function Be(z,c,v){nr(z,M=>{M.call(e,c,v,W)})}let on=function(c){let v=null;if(Be(B.beforeSanitizeElements,c,null),wr(c))return Fe(c),!0;let M=ce(c.nodeName);if(Be(B.uponSanitizeElement,c,{tagName:M,allowedTags:H}),j&&c.hasChildNodes()&&!sn(c.firstElementChild)&&xe(/<[/\w!]/g,c.innerHTML)&&xe(/<[/\w!]/g,c.textContent)||c.nodeType===Pt.progressingInstruction||j&&c.nodeType===Pt.comment&&xe(/<[/\w]/g,c.data))return Fe(c),!0;if(!(_e.tagCheck instanceof Function&&_e.tagCheck(M))&&(!H[M]||ke[M])){if(!ke[M]&&ln(M)&&(X.tagNameCheck instanceof RegExp&&xe(X.tagNameCheck,M)||X.tagNameCheck instanceof Function&&X.tagNameCheck(M)))return!1;if(D&&!Ke[M]){let oe=I(c)||c.parentNode,we=P(c)||c.childNodes;if(we&&oe){let ue=we.length;for(let Ee=ue-1;Ee>=0;--Ee){let He=y(we[Ee],!0);He.__removalCount=(c.__removalCount||0)+1,oe.insertBefore(He,_(c))}}}return Fe(c),!0}return c instanceof a&&!Ss(c)||(M==="noscript"||M==="noembed"||M==="noframes")&&xe(/<\/no(script|embed|frames)/i,c.innerHTML)?(Fe(c),!0):(g&&c.nodeType===Pt.text&&(v=c.textContent,nr([te,Y,b],oe=>{v=Nt(v,oe," ")}),c.textContent!==v&&(Dt(e.removed,{element:c.cloneNode()}),c.textContent=v)),Be(B.afterSanitizeElements,c,null),!1)},an=function(c,v,M){if(Wt&&(v==="id"||v==="name")&&(M in t||M in de))return!1;if(!(Ie&&!$e[v]&&xe(T,v))){if(!(De&&xe(F,v))){if(!(_e.attributeCheck instanceof Function&&_e.attributeCheck(v,c))){if(!re[v]||$e[v]){if(!(ln(c)&&(X.tagNameCheck instanceof RegExp&&xe(X.tagNameCheck,c)||X.tagNameCheck instanceof Function&&X.tagNameCheck(c))&&(X.attributeNameCheck instanceof RegExp&&xe(X.attributeNameCheck,v)||X.attributeNameCheck instanceof Function&&X.attributeNameCheck(v,c))||v==="is"&&X.allowCustomizedBuiltInElements&&(X.tagNameCheck instanceof RegExp&&xe(X.tagNameCheck,M)||X.tagNameCheck instanceof Function&&X.tagNameCheck(M))))return!1}else if(!St[v]){if(!xe(ie,Nt(M,U,""))){if(!((v==="src"||v==="xlink:href"||v==="href")&&c!=="script"&&ni(M,"data:")===0&&Vt[c])){if(!(je&&!xe(Z,Nt(M,U,"")))){if(M)return!1}}}}}}}return!0},ln=function(c){return c!=="annotation-xml"&&Dr(c,J)},cn=function(c){Be(B.beforeSanitizeAttributes,c,null);let{attributes:v}=c;if(!v||wr(c))return;let M={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:re,forceKeepAttr:void 0},oe=v.length;for(;oe--;){let we=v[oe],{name:ue,namespaceURI:Ee,value:He}=we,mt=ce(ue),kr=He,ye=ue==="value"?kr:si(kr);if(M.attrName=mt,M.attrValue=ye,M.keepAttr=!0,M.forceKeepAttr=void 0,Be(B.uponSanitizeAttribute,c,M),ye=M.attrValue,At&&(mt==="id"||mt==="name")&&(rt(ue,c),ye=mr+ye),j&&xe(/((--!?|])>)|<\/(style|title|textarea)/i,ye)){rt(ue,c);continue}if(mt==="attributename"&&Dr(ye,"href")){rt(ue,c);continue}if(M.forceKeepAttr)continue;if(!M.keepAttr){rt(ue,c);continue}if(!x&&xe(/\/>/i,ye)){rt(ue,c);continue}g&&nr([te,Y,b],un=>{ye=Nt(ye,un," ")});let dn=ce(c.nodeName);if(!an(dn,mt,ye)){rt(ue,c);continue}if(C&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!Ee)switch(m.getAttributeType(dn,mt)){case"TrustedHTML":{ye=C.createHTML(ye);break}case"TrustedScriptURL":{ye=C.createScriptURL(ye);break}}if(ye!==kr)try{Ee?c.setAttributeNS(Ee,ue,ye):c.setAttribute(ue,ye),wr(c)?Fe(c):Pn(e.removed)}catch{rt(ue,c)}}Be(B.afterSanitizeAttributes,c,null)},Ts=function z(c){let v=null,M=nn(c);for(Be(B.beforeSanitizeShadowDOM,c,null);v=M.nextNode();)Be(B.uponSanitizeShadowNode,v,null),on(v),cn(v),v.content instanceof i&&z(v.content);Be(B.afterSanitizeShadowDOM,c,null)};return e.sanitize=function(z){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v=null,M=null,oe=null,we=null;if(me=!z,me&&(z="<!-->"),typeof z!="string"&&!sn(z))if(typeof z.toString=="function"){if(z=z.toString(),typeof z!="string")throw Mt("dirty is not a string, aborting")}else throw Mt("toString is not a function");if(!e.isSupported)return z;if(pe||Xt(c),e.removed=[],typeof z=="string"&&(et=!1),et){if(z.nodeName){let He=ce(z.nodeName);if(!H[He]||ke[He])throw Mt("root node is forbidden and cannot be sanitized in-place")}}else if(z instanceof l)v=rn("<!---->"),M=v.ownerDocument.importNode(z,!0),M.nodeType===Pt.element&&M.nodeName==="BODY"||M.nodeName==="HTML"?v=M:v.appendChild(M);else{if(!Ge&&!g&&!q&&z.indexOf("<")===-1)return C&&Je?C.createHTML(z):z;if(v=rn(z),!v)return Ge?null:Je?O:""}v&&fe&&Fe(v.firstChild);let ue=nn(et?z:v);for(;oe=ue.nextNode();)on(oe),cn(oe),oe.content instanceof i&&Ts(oe.content);if(et)return z;if(Ge){if(pt)for(we=k.call(v.ownerDocument);v.firstChild;)we.appendChild(v.firstChild);else we=v;return(re.shadowroot||re.shadowrootmode)&&(we=L.call(s,we,!0)),we}let Ee=q?v.outerHTML:v.innerHTML;return q&&H["!doctype"]&&v.ownerDocument&&v.ownerDocument.doctype&&v.ownerDocument.doctype.name&&xe(Wn,v.ownerDocument.doctype.name)&&(Ee="<!DOCTYPE "+v.ownerDocument.doctype.name+`>
`+Ee),g&&nr([te,Y,b],He=>{Ee=Nt(Ee,He," ")}),C&&Je?C.createHTML(Ee):Ee},e.setConfig=function(){let z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Xt(z),pe=!0},e.clearConfig=function(){W=null,pe=!1},e.isValidAttribute=function(z,c,v){W||Xt({});let M=ce(z),oe=ce(c);return an(M,oe,v)},e.addHook=function(z,c){typeof c=="function"&&Dt(B[z],c)},e.removeHook=function(z,c){if(c!==void 0){let v=ti(B[z],c);return v===-1?void 0:ri(B[z],v,1)[0]}return Pn(B[z])},e.removeHooks=function(z){B[z]=[]},e.removeAllHooks=function(){B=qn()},e}var Vn=Kn();var Zn={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},Yn=r=>(...e)=>({_$litDirective$:r,values:e}),or=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,s){this._$Ct=e,this._$AM=t,this._$Ci=s}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}};var Ft=class extends or{constructor(e){if(super(e),this.it=le,e.type!==Zn.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(e){if(e===le||e==null)return this._t=void 0,this.it=e;if(e===ot)return e;if(typeof e!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(e===this.it)return this._t;this.it=e;let t=[e];return t.raw=t,this._t={_$litType$:this.constructor.resultType,strings:t,values:[]}}};Ft.directiveName="unsafeHTML",Ft.resultType=1;var Xn=Yn(Ft);function jr(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var dt=jr();function ss(r){dt=r}var Ut={exec:()=>null};function Q(r,e=""){let t=typeof r=="string"?r:r.source,s={replace:(n,i)=>{let o=typeof i=="string"?i:i.source;return o=o.replace(Se.caret,"$1"),t=t.replace(n,o),s},getRegex:()=>new RegExp(t,e)};return s}var wi=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Se={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:r=>new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}#`),htmlBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}<(?:[a-z].*>|!--)`,"i")},ki=/^(?:[ \t]*(?:\n|$))+/,_i=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,xi=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,qt=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,vi=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Gr=/(?:[*+-]|\d{1,9}[.)])/,is=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,os=Q(is).replace(/bull/g,Gr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Ai=Q(is).replace(/bull/g,Gr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Wr=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Si=/^[^\n]+/,Kr=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Ti=Q(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Kr).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),$i=Q(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Gr).getRegex(),pr="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Vr=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Ei=Q("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Vr).replace("tag",pr).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),as=Q(Wr).replace("hr",qt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",pr).getRegex(),Ci=Q(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",as).getRegex(),Zr={blockquote:Ci,code:_i,def:Ti,fences:xi,heading:vi,hr:qt,html:Ei,lheading:os,list:$i,newline:ki,paragraph:as,table:Ut,text:Si},Qn=Q("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",qt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",pr).getRegex(),Ri={...Zr,lheading:Ai,table:Qn,paragraph:Q(Wr).replace("hr",qt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Qn).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",pr).getRegex()},Ii={...Zr,html:Q(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Vr).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ut,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Q(Wr).replace("hr",qt).replace("heading",` *#{1,6} *[^
]`).replace("lheading",os).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Li=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Di=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ls=/^( {2,}|\\)\n(?!\s*$)/,Ni=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,fr=/[\p{P}\p{S}]/u,Yr=/[\s\p{P}\p{S}]/u,cs=/[^\s\p{P}\p{S}]/u,Mi=Q(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Yr).getRegex(),ds=/(?!~)[\p{P}\p{S}]/u,Oi=/(?!~)[\s\p{P}\p{S}]/u,Pi=/(?:[^\s\p{P}\p{S}]|~)/u,Fi=Q(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",wi?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),us=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,zi=Q(us,"u").replace(/punct/g,fr).getRegex(),Bi=Q(us,"u").replace(/punct/g,ds).getRegex(),ps="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Hi=Q(ps,"gu").replace(/notPunctSpace/g,cs).replace(/punctSpace/g,Yr).replace(/punct/g,fr).getRegex(),Ui=Q(ps,"gu").replace(/notPunctSpace/g,Pi).replace(/punctSpace/g,Oi).replace(/punct/g,ds).getRegex(),qi=Q("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,cs).replace(/punctSpace/g,Yr).replace(/punct/g,fr).getRegex(),ji=Q(/\\(punct)/,"gu").replace(/punct/g,fr).getRegex(),Gi=Q(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Wi=Q(Vr).replace("(?:-->|$)","-->").getRegex(),Ki=Q("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Wi).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),cr=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Vi=Q(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",cr).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),fs=Q(/^!?\[(label)\]\[(ref)\]/).replace("label",cr).replace("ref",Kr).getRegex(),hs=Q(/^!?\[(ref)\](?:\[\])?/).replace("ref",Kr).getRegex(),Zi=Q("reflink|nolink(?!\\()","g").replace("reflink",fs).replace("nolink",hs).getRegex(),Jn=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Xr={_backpedal:Ut,anyPunctuation:ji,autolink:Gi,blockSkip:Fi,br:ls,code:Di,del:Ut,emStrongLDelim:zi,emStrongRDelimAst:Hi,emStrongRDelimUnd:qi,escape:Li,link:Vi,nolink:hs,punctuation:Mi,reflink:fs,reflinkSearch:Zi,tag:Ki,text:Ni,url:Ut},Yi={...Xr,link:Q(/^!?\[(label)\]\((.*?)\)/).replace("label",cr).getRegex(),reflink:Q(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",cr).getRegex()},Hr={...Xr,emStrongRDelimAst:Ui,emStrongLDelim:Bi,url:Q(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Jn).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Q(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Jn).getRegex()},Xi={...Hr,br:Q(ls).replace("{2,}","*").getRegex(),text:Q(Hr.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ar={normal:Zr,gfm:Ri,pedantic:Ii},zt={normal:Xr,gfm:Hr,breaks:Xi,pedantic:Yi},Qi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},es=r=>Qi[r];function qe(r,e){if(e){if(Se.escapeTest.test(r))return r.replace(Se.escapeReplace,es)}else if(Se.escapeTestNoEncode.test(r))return r.replace(Se.escapeReplaceNoEncode,es);return r}function ts(r){try{r=encodeURI(r).replace(Se.percentDecode,"%")}catch{return null}return r}function rs(r,e){let t=r.replace(Se.findPipe,(i,o,l)=>{let a=!1,f=o;for(;--f>=0&&l[f]==="\\";)a=!a;return a?"|":" |"}),s=t.split(Se.splitPipe),n=0;if(s[0].trim()||s.shift(),s.length>0&&!s.at(-1)?.trim()&&s.pop(),e)if(s.length>e)s.splice(e);else for(;s.length<e;)s.push("");for(;n<s.length;n++)s[n]=s[n].trim().replace(Se.slashPipe,"|");return s}function Bt(r,e,t){let s=r.length;if(s===0)return"";let n=0;for(;n<s;){let i=r.charAt(s-n-1);if(i===e&&!t)n++;else if(i!==e&&t)n++;else break}return r.slice(0,s-n)}function Ji(r,e){if(r.indexOf(e[1])===-1)return-1;let t=0;for(let s=0;s<r.length;s++)if(r[s]==="\\")s++;else if(r[s]===e[0])t++;else if(r[s]===e[1]&&(t--,t<0))return s;return t>0?-2:-1}function ns(r,e,t,s,n){let i=e.href,o=e.title||null,l=r[1].replace(n.other.outputLinkReplace,"$1");s.state.inLink=!0;let a={type:r[0].charAt(0)==="!"?"image":"link",raw:t,href:i,title:o,text:l,tokens:s.inlineTokens(l)};return s.state.inLink=!1,a}function eo(r,e,t){let s=r.match(t.other.indentCodeCompensation);if(s===null)return e;let n=s[1];return e.split(`
`).map(i=>{let o=i.match(t.other.beginningSpace);if(o===null)return i;let[l]=o;return l.length>=n.length?i.slice(n.length):i}).join(`
`)}var dr=class{constructor(r){se(this,"options");se(this,"rules");se(this,"lexer");this.options=r||dt}space(r){let e=this.rules.block.newline.exec(r);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(r){let e=this.rules.block.code.exec(r);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:Bt(t,`
`)}}}fences(r){let e=this.rules.block.fences.exec(r);if(e){let t=e[0],s=eo(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:s}}}heading(r){let e=this.rules.block.heading.exec(r);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let s=Bt(t,"#");(this.options.pedantic||!s||this.rules.other.endingSpaceChar.test(s))&&(t=s.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(r){let e=this.rules.block.hr.exec(r);if(e)return{type:"hr",raw:Bt(e[0],`
`)}}blockquote(r){let e=this.rules.block.blockquote.exec(r);if(e){let t=Bt(e[0],`
`).split(`
`),s="",n="",i=[];for(;t.length>0;){let o=!1,l=[],a;for(a=0;a<t.length;a++)if(this.rules.other.blockquoteStart.test(t[a]))l.push(t[a]),o=!0;else if(!o)l.push(t[a]);else break;t=t.slice(a);let f=l.join(`
`),u=f.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}
${f}`:f,n=n?`${n}
${u}`:u;let p=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,i,!0),this.lexer.state.top=p,t.length===0)break;let h=i.at(-1);if(h?.type==="code")break;if(h?.type==="blockquote"){let m=h,w=m.raw+`
`+t.join(`
`),y=this.blockquote(w);i[i.length-1]=y,s=s.substring(0,s.length-m.raw.length)+y.raw,n=n.substring(0,n.length-m.text.length)+y.text;break}else if(h?.type==="list"){let m=h,w=m.raw+`
`+t.join(`
`),y=this.list(w);i[i.length-1]=y,s=s.substring(0,s.length-h.raw.length)+y.raw,n=n.substring(0,n.length-m.raw.length)+y.raw,t=w.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:i,text:n}}}list(r){let e=this.rules.block.list.exec(r);if(e){let t=e[1].trim(),s=t.length>1,n={type:"list",raw:"",ordered:s,start:s?+t.slice(0,-1):"",loose:!1,items:[]};t=s?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=s?t:"[*+-]");let i=this.rules.other.listItemRegex(t),o=!1;for(;r;){let a=!1,f="",u="";if(!(e=i.exec(r))||this.rules.block.hr.test(r))break;f=e[0],r=r.substring(f.length);let p=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,y=>" ".repeat(3*y.length)),h=r.split(`
`,1)[0],m=!p.trim(),w=0;if(this.options.pedantic?(w=2,u=p.trimStart()):m?w=e[1].length+1:(w=e[2].search(this.rules.other.nonSpaceChar),w=w>4?1:w,u=p.slice(w),w+=e[1].length),m&&this.rules.other.blankLine.test(h)&&(f+=h+`
`,r=r.substring(h.length+1),a=!0),!a){let y=this.rules.other.nextBulletRegex(w),E=this.rules.other.hrRegex(w),_=this.rules.other.fencesBeginRegex(w),P=this.rules.other.headingBeginRegex(w),I=this.rules.other.htmlBeginRegex(w);for(;r;){let C=r.split(`
`,1)[0],O;if(h=C,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),O=h):O=h.replace(this.rules.other.tabCharGlobal,"    "),_.test(h)||P.test(h)||I.test(h)||y.test(h)||E.test(h))break;if(O.search(this.rules.other.nonSpaceChar)>=w||!h.trim())u+=`
`+O.slice(w);else{if(m||p.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||_.test(p)||P.test(p)||E.test(p))break;u+=`
`+h}!m&&!h.trim()&&(m=!0),f+=C+`
`,r=r.substring(C.length+1),p=O.slice(w)}}n.loose||(o?n.loose=!0:this.rules.other.doubleBlankLine.test(f)&&(o=!0)),n.items.push({type:"list_item",raw:f,task:!!this.options.gfm&&this.rules.other.listIsTask.test(u),loose:!1,text:u,tokens:[]}),n.raw+=f}let l=n.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;n.raw=n.raw.trimEnd();for(let a of n.items){if(this.lexer.state.top=!1,a.tokens=this.lexer.blockTokens(a.text,[]),a.task){if(a.text=a.text.replace(this.rules.other.listReplaceTask,""),a.tokens[0]?.type==="text"||a.tokens[0]?.type==="paragraph"){a.tokens[0].raw=a.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),a.tokens[0].text=a.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let u=this.lexer.inlineQueue.length-1;u>=0;u--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[u].src)){this.lexer.inlineQueue[u].src=this.lexer.inlineQueue[u].src.replace(this.rules.other.listReplaceTask,"");break}}let f=this.rules.other.listTaskCheckbox.exec(a.raw);if(f){let u={type:"checkbox",raw:f[0]+" ",checked:f[0]!=="[ ]"};a.checked=u.checked,n.loose?a.tokens[0]&&["paragraph","text"].includes(a.tokens[0].type)&&"tokens"in a.tokens[0]&&a.tokens[0].tokens?(a.tokens[0].raw=u.raw+a.tokens[0].raw,a.tokens[0].text=u.raw+a.tokens[0].text,a.tokens[0].tokens.unshift(u)):a.tokens.unshift({type:"paragraph",raw:u.raw,text:u.raw,tokens:[u]}):a.tokens.unshift(u)}}if(!n.loose){let f=a.tokens.filter(p=>p.type==="space"),u=f.length>0&&f.some(p=>this.rules.other.anyLine.test(p.raw));n.loose=u}}if(n.loose)for(let a of n.items){a.loose=!0;for(let f of a.tokens)f.type==="text"&&(f.type="paragraph")}return n}}html(r){let e=this.rules.block.html.exec(r);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(r){let e=this.rules.block.def.exec(r);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:s,title:n}}}table(r){let e=this.rules.block.table.exec(r);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=rs(e[1]),s=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),n=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===s.length){for(let o of s)this.rules.other.tableAlignRight.test(o)?i.align.push("right"):this.rules.other.tableAlignCenter.test(o)?i.align.push("center"):this.rules.other.tableAlignLeft.test(o)?i.align.push("left"):i.align.push(null);for(let o=0;o<t.length;o++)i.header.push({text:t[o],tokens:this.lexer.inline(t[o]),header:!0,align:i.align[o]});for(let o of n)i.rows.push(rs(o,i.header.length).map((l,a)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:i.align[a]})));return i}}lheading(r){let e=this.rules.block.lheading.exec(r);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(r){let e=this.rules.block.paragraph.exec(r);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(r){let e=this.rules.block.text.exec(r);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(r){let e=this.rules.inline.escape.exec(r);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(r){let e=this.rules.inline.tag.exec(r);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(r){let e=this.rules.inline.link.exec(r);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let i=Bt(t.slice(0,-1),"\\");if((t.length-i.length)%2===0)return}else{let i=Ji(e[2],"()");if(i===-2)return;if(i>-1){let o=(e[0].indexOf("!")===0?5:4)+e[1].length+i;e[2]=e[2].substring(0,i),e[0]=e[0].substring(0,o).trim(),e[3]=""}}let s=e[2],n="";if(this.options.pedantic){let i=this.rules.other.pedanticHrefTitle.exec(s);i&&(s=i[1],n=i[3])}else n=e[3]?e[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?s=s.slice(1):s=s.slice(1,-1)),ns(e,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:n&&n.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(r,e){let t;if((t=this.rules.inline.reflink.exec(r))||(t=this.rules.inline.nolink.exec(r))){let s=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),n=e[s.toLowerCase()];if(!n){let i=t[0].charAt(0);return{type:"text",raw:i,text:i}}return ns(t,n,t[0],this.lexer,this.rules)}}emStrong(r,e,t=""){let s=this.rules.inline.emStrongLDelim.exec(r);if(!(!s||s[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(s[1]||s[2])||!t||this.rules.inline.punctuation.exec(t))){let n=[...s[0]].length-1,i,o,l=n,a=0,f=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(f.lastIndex=0,e=e.slice(-1*r.length+n);(s=f.exec(e))!=null;){if(i=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!i)continue;if(o=[...i].length,s[3]||s[4]){l+=o;continue}else if((s[5]||s[6])&&n%3&&!((n+o)%3)){a+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+a);let u=[...s[0]][0].length,p=r.slice(0,n+s.index+u+o);if(Math.min(n,o)%2){let m=p.slice(1,-1);return{type:"em",raw:p,text:m,tokens:this.lexer.inlineTokens(m)}}let h=p.slice(2,-2);return{type:"strong",raw:p,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(r){let e=this.rules.inline.code.exec(r);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),s=this.rules.other.nonSpaceChar.test(t),n=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return s&&n&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(r){let e=this.rules.inline.br.exec(r);if(e)return{type:"br",raw:e[0]}}del(r){let e=this.rules.inline.del.exec(r);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(r){let e=this.rules.inline.autolink.exec(r);if(e){let t,s;return e[2]==="@"?(t=e[1],s="mailto:"+t):(t=e[1],s=t),{type:"link",raw:e[0],text:t,href:s,tokens:[{type:"text",raw:t,text:t}]}}}url(r){let e;if(e=this.rules.inline.url.exec(r)){let t,s;if(e[2]==="@")t=e[0],s="mailto:"+t;else{let n;do n=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(n!==e[0]);t=e[0],e[1]==="www."?s="http://"+e[0]:s=e[0]}return{type:"link",raw:e[0],text:t,href:s,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(r){let e=this.rules.inline.text.exec(r);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},Oe=class Ur{constructor(e){se(this,"tokens");se(this,"options");se(this,"state");se(this,"inlineQueue");se(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||dt,this.options.tokenizer=this.options.tokenizer||new dr,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:Se,block:ar.normal,inline:zt.normal};this.options.pedantic?(t.block=ar.pedantic,t.inline=zt.pedantic):this.options.gfm&&(t.block=ar.gfm,this.options.breaks?t.inline=zt.breaks:t.inline=zt.gfm),this.tokenizer.rules=t}static get rules(){return{block:ar,inline:zt}}static lex(e,t){return new Ur(t).lex(e)}static lexInline(e,t){return new Ur(t).inlineTokens(e)}lex(e){e=e.replace(Se.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let s=this.inlineQueue[t];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],s=!1){for(this.options.pedantic&&(e=e.replace(Se.tabCharGlobal,"    ").replace(Se.spaceLine,""));e;){let n;if(this.options.extensions?.block?.some(o=>(n=o.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))continue;if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length);let o=t.at(-1);n.raw.length===1&&o!==void 0?o.raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length);let o=t.at(-1);o?.type==="paragraph"||o?.type==="text"?(o.raw+=(o.raw.endsWith(`
`)?"":`
`)+n.raw,o.text+=`
`+n.text,this.inlineQueue.at(-1).src=o.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length);let o=t.at(-1);o?.type==="paragraph"||o?.type==="text"?(o.raw+=(o.raw.endsWith(`
`)?"":`
`)+n.raw,o.text+=`
`+n.raw,this.inlineQueue.at(-1).src=o.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title},t.push(n));continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}let i=e;if(this.options.extensions?.startBlock){let o=1/0,l=e.slice(1),a;this.options.extensions.startBlock.forEach(f=>{a=f.call({lexer:this},l),typeof a=="number"&&a>=0&&(o=Math.min(o,a))}),o<1/0&&o>=0&&(i=e.substring(0,o+1))}if(this.state.top&&(n=this.tokenizer.paragraph(i))){let o=t.at(-1);s&&o?.type==="paragraph"?(o.raw+=(o.raw.endsWith(`
`)?"":`
`)+n.raw,o.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):t.push(n),s=i.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length);let o=t.at(-1);o?.type==="text"?(o.raw+=(o.raw.endsWith(`
`)?"":`
`)+n.raw,o.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):t.push(n);continue}if(e){let o="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(o);break}else throw new Error(o)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let s=e,n=null;if(this.tokens.links){let a=Object.keys(this.tokens.links);if(a.length>0)for(;(n=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)a.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(n=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,n.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i;for(;(n=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)i=n[2]?n[2].length:0,s=s.slice(0,n.index+i)+"["+"a".repeat(n[0].length-i-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);s=this.options.hooks?.emStrongMask?.call({lexer:this},s)??s;let o=!1,l="";for(;e;){o||(l=""),o=!1;let a;if(this.options.extensions?.inline?.some(u=>(a=u.call({lexer:this},e,t))?(e=e.substring(a.raw.length),t.push(a),!0):!1))continue;if(a=this.tokenizer.escape(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.tag(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.link(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(a.raw.length);let u=t.at(-1);a.type==="text"&&u?.type==="text"?(u.raw+=a.raw,u.text+=a.text):t.push(a);continue}if(a=this.tokenizer.emStrong(e,s,l)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.codespan(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.br(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.del(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.autolink(e)){e=e.substring(a.raw.length),t.push(a);continue}if(!this.state.inLink&&(a=this.tokenizer.url(e))){e=e.substring(a.raw.length),t.push(a);continue}let f=e;if(this.options.extensions?.startInline){let u=1/0,p=e.slice(1),h;this.options.extensions.startInline.forEach(m=>{h=m.call({lexer:this},p),typeof h=="number"&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(f=e.substring(0,u+1))}if(a=this.tokenizer.inlineText(f)){e=e.substring(a.raw.length),a.raw.slice(-1)!=="_"&&(l=a.raw.slice(-1)),o=!0;let u=t.at(-1);u?.type==="text"?(u.raw+=a.raw,u.text+=a.text):t.push(a);continue}if(e){let u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return t}},ur=class{constructor(r){se(this,"options");se(this,"parser");this.options=r||dt}space(r){return""}code({text:r,lang:e,escaped:t}){let s=(e||"").match(Se.notSpaceStart)?.[0],n=r.replace(Se.endingNewline,"")+`
`;return s?'<pre><code class="language-'+qe(s)+'">'+(t?n:qe(n,!0))+`</code></pre>
`:"<pre><code>"+(t?n:qe(n,!0))+`</code></pre>
`}blockquote({tokens:r}){return`<blockquote>
${this.parser.parse(r)}</blockquote>
`}html({text:r}){return r}def(r){return""}heading({tokens:r,depth:e}){return`<h${e}>${this.parser.parseInline(r)}</h${e}>
`}hr(r){return`<hr>
`}list(r){let e=r.ordered,t=r.start,s="";for(let o=0;o<r.items.length;o++){let l=r.items[o];s+=this.listitem(l)}let n=e?"ol":"ul",i=e&&t!==1?' start="'+t+'"':"";return"<"+n+i+`>
`+s+"</"+n+`>
`}listitem(r){return`<li>${this.parser.parse(r.tokens)}</li>
`}checkbox({checked:r}){return"<input "+(r?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:r}){return`<p>${this.parser.parseInline(r)}</p>
`}table(r){let e="",t="";for(let n=0;n<r.header.length;n++)t+=this.tablecell(r.header[n]);e+=this.tablerow({text:t});let s="";for(let n=0;n<r.rows.length;n++){let i=r.rows[n];t="";for(let o=0;o<i.length;o++)t+=this.tablecell(i[o]);s+=this.tablerow({text:t})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+s+`</table>
`}tablerow({text:r}){return`<tr>
${r}</tr>
`}tablecell(r){let e=this.parser.parseInline(r.tokens),t=r.header?"th":"td";return(r.align?`<${t} align="${r.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:r}){return`<strong>${this.parser.parseInline(r)}</strong>`}em({tokens:r}){return`<em>${this.parser.parseInline(r)}</em>`}codespan({text:r}){return`<code>${qe(r,!0)}</code>`}br(r){return"<br>"}del({tokens:r}){return`<del>${this.parser.parseInline(r)}</del>`}link({href:r,title:e,tokens:t}){let s=this.parser.parseInline(t),n=ts(r);if(n===null)return s;r=n;let i='<a href="'+r+'"';return e&&(i+=' title="'+qe(e)+'"'),i+=">"+s+"</a>",i}image({href:r,title:e,text:t,tokens:s}){s&&(t=this.parser.parseInline(s,this.parser.textRenderer));let n=ts(r);if(n===null)return qe(t);r=n;let i=`<img src="${r}" alt="${t}"`;return e&&(i+=` title="${qe(e)}"`),i+=">",i}text(r){return"tokens"in r&&r.tokens?this.parser.parseInline(r.tokens):"escaped"in r&&r.escaped?r.text:qe(r.text)}},Qr=class{strong({text:r}){return r}em({text:r}){return r}codespan({text:r}){return r}del({text:r}){return r}html({text:r}){return r}text({text:r}){return r}link({text:r}){return""+r}image({text:r}){return""+r}br(){return""}checkbox({raw:r}){return r}},Pe=class qr{constructor(e){se(this,"options");se(this,"renderer");se(this,"textRenderer");this.options=e||dt,this.options.renderer=this.options.renderer||new ur,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Qr}static parse(e,t){return new qr(t).parse(e)}static parseInline(e,t){return new qr(t).parseInline(e)}parse(e){let t="";for(let s=0;s<e.length;s++){let n=e[s];if(this.options.extensions?.renderers?.[n.type]){let o=n,l=this.options.extensions.renderers[o.type].call({parser:this},o);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(o.type)){t+=l||"";continue}}let i=n;switch(i.type){case"space":{t+=this.renderer.space(i);break}case"hr":{t+=this.renderer.hr(i);break}case"heading":{t+=this.renderer.heading(i);break}case"code":{t+=this.renderer.code(i);break}case"table":{t+=this.renderer.table(i);break}case"blockquote":{t+=this.renderer.blockquote(i);break}case"list":{t+=this.renderer.list(i);break}case"checkbox":{t+=this.renderer.checkbox(i);break}case"html":{t+=this.renderer.html(i);break}case"def":{t+=this.renderer.def(i);break}case"paragraph":{t+=this.renderer.paragraph(i);break}case"text":{t+=this.renderer.text(i);break}default:{let o='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return t}parseInline(e,t=this.renderer){let s="";for(let n=0;n<e.length;n++){let i=e[n];if(this.options.extensions?.renderers?.[i.type]){let l=this.options.extensions.renderers[i.type].call({parser:this},i);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){s+=l||"";continue}}let o=i;switch(o.type){case"escape":{s+=t.text(o);break}case"html":{s+=t.html(o);break}case"link":{s+=t.link(o);break}case"image":{s+=t.image(o);break}case"checkbox":{s+=t.checkbox(o);break}case"strong":{s+=t.strong(o);break}case"em":{s+=t.em(o);break}case"codespan":{s+=t.codespan(o);break}case"br":{s+=t.br(o);break}case"del":{s+=t.del(o);break}case"text":{s+=t.text(o);break}default:{let l='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return s}},lr,Ht=(lr=class{constructor(r){se(this,"options");se(this,"block");this.options=r||dt}preprocess(r){return r}postprocess(r){return r}processAllTokens(r){return r}emStrongMask(r){return r}provideLexer(){return this.block?Oe.lex:Oe.lexInline}provideParser(){return this.block?Pe.parse:Pe.parseInline}},se(lr,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),se(lr,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),lr),to=class{constructor(...r){se(this,"defaults",jr());se(this,"options",this.setOptions);se(this,"parse",this.parseMarkdown(!0));se(this,"parseInline",this.parseMarkdown(!1));se(this,"Parser",Pe);se(this,"Renderer",ur);se(this,"TextRenderer",Qr);se(this,"Lexer",Oe);se(this,"Tokenizer",dr);se(this,"Hooks",Ht);this.use(...r)}walkTokens(r,e){let t=[];for(let s of r)switch(t=t.concat(e.call(this,s)),s.type){case"table":{let n=s;for(let i of n.header)t=t.concat(this.walkTokens(i.tokens,e));for(let i of n.rows)for(let o of i)t=t.concat(this.walkTokens(o.tokens,e));break}case"list":{let n=s;t=t.concat(this.walkTokens(n.items,e));break}default:{let n=s;this.defaults.extensions?.childTokens?.[n.type]?this.defaults.extensions.childTokens[n.type].forEach(i=>{let o=n[i].flat(1/0);t=t.concat(this.walkTokens(o,e))}):n.tokens&&(t=t.concat(this.walkTokens(n.tokens,e)))}}return t}use(...r){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return r.forEach(t=>{let s={...t};if(s.async=this.defaults.async||s.async||!1,t.extensions&&(t.extensions.forEach(n=>{if(!n.name)throw new Error("extension name required");if("renderer"in n){let i=e.renderers[n.name];i?e.renderers[n.name]=function(...o){let l=n.renderer.apply(this,o);return l===!1&&(l=i.apply(this,o)),l}:e.renderers[n.name]=n.renderer}if("tokenizer"in n){if(!n.level||n.level!=="block"&&n.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let i=e[n.level];i?i.unshift(n.tokenizer):e[n.level]=[n.tokenizer],n.start&&(n.level==="block"?e.startBlock?e.startBlock.push(n.start):e.startBlock=[n.start]:n.level==="inline"&&(e.startInline?e.startInline.push(n.start):e.startInline=[n.start]))}"childTokens"in n&&n.childTokens&&(e.childTokens[n.name]=n.childTokens)}),s.extensions=e),t.renderer){let n=this.defaults.renderer||new ur(this.defaults);for(let i in t.renderer){if(!(i in n))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;let o=i,l=t.renderer[o],a=n[o];n[o]=(...f)=>{let u=l.apply(n,f);return u===!1&&(u=a.apply(n,f)),u||""}}s.renderer=n}if(t.tokenizer){let n=this.defaults.tokenizer||new dr(this.defaults);for(let i in t.tokenizer){if(!(i in n))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;let o=i,l=t.tokenizer[o],a=n[o];n[o]=(...f)=>{let u=l.apply(n,f);return u===!1&&(u=a.apply(n,f)),u}}s.tokenizer=n}if(t.hooks){let n=this.defaults.hooks||new Ht;for(let i in t.hooks){if(!(i in n))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;let o=i,l=t.hooks[o],a=n[o];Ht.passThroughHooks.has(i)?n[o]=f=>{if(this.defaults.async&&Ht.passThroughHooksRespectAsync.has(i))return(async()=>{let p=await l.call(n,f);return a.call(n,p)})();let u=l.call(n,f);return a.call(n,u)}:n[o]=(...f)=>{if(this.defaults.async)return(async()=>{let p=await l.apply(n,f);return p===!1&&(p=await a.apply(n,f)),p})();let u=l.apply(n,f);return u===!1&&(u=a.apply(n,f)),u}}s.hooks=n}if(t.walkTokens){let n=this.defaults.walkTokens,i=t.walkTokens;s.walkTokens=function(o){let l=[];return l.push(i.call(this,o)),n&&(l=l.concat(n.call(this,o))),l}}this.defaults={...this.defaults,...s}}),this}setOptions(r){return this.defaults={...this.defaults,...r},this}lexer(r,e){return Oe.lex(r,e??this.defaults)}parser(r,e){return Pe.parse(r,e??this.defaults)}parseMarkdown(r){return(e,t)=>{let s={...t},n={...this.defaults,...s},i=this.onError(!!n.silent,!!n.async);if(this.defaults.async===!0&&s.async===!1)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return i(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(n.hooks&&(n.hooks.options=n,n.hooks.block=r),n.async)return(async()=>{let o=n.hooks?await n.hooks.preprocess(e):e,l=await(n.hooks?await n.hooks.provideLexer():r?Oe.lex:Oe.lexInline)(o,n),a=n.hooks?await n.hooks.processAllTokens(l):l;n.walkTokens&&await Promise.all(this.walkTokens(a,n.walkTokens));let f=await(n.hooks?await n.hooks.provideParser():r?Pe.parse:Pe.parseInline)(a,n);return n.hooks?await n.hooks.postprocess(f):f})().catch(i);try{n.hooks&&(e=n.hooks.preprocess(e));let o=(n.hooks?n.hooks.provideLexer():r?Oe.lex:Oe.lexInline)(e,n);n.hooks&&(o=n.hooks.processAllTokens(o)),n.walkTokens&&this.walkTokens(o,n.walkTokens);let l=(n.hooks?n.hooks.provideParser():r?Pe.parse:Pe.parseInline)(o,n);return n.hooks&&(l=n.hooks.postprocess(l)),l}catch(o){return i(o)}}}onError(r,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,r){let s="<p>An error occurred:</p><pre>"+qe(t.message+"",!0)+"</pre>";return e?Promise.resolve(s):s}if(e)return Promise.reject(t);throw t}}},ct=new to;function ne(r,e){return ct.parse(r,e)}ne.options=ne.setOptions=function(r){return ct.setOptions(r),ne.defaults=ct.defaults,ss(ne.defaults),ne};ne.getDefaults=jr;ne.defaults=dt;ne.use=function(...r){return ct.use(...r),ne.defaults=ct.defaults,ss(ne.defaults),ne};ne.walkTokens=function(r,e){return ct.walkTokens(r,e)};ne.parseInline=ct.parseInline;ne.Parser=Pe;ne.parser=Pe.parse;ne.Renderer=ur;ne.TextRenderer=Qr;ne.Lexer=Oe;ne.lexer=Oe.lex;ne.Tokenizer=dr;ne.Hooks=Ht;ne.parse=ne;var Jo=ne.options,ea=ne.setOptions,ta=ne.use,ra=ne.walkTokens,na=ne.parseInline;var sa=Pe.parse,ia=Oe.lex;function jt(r){let e=ne.parse(r),t=Vn.sanitize(e);return Xn(t)}function ut(r){switch((r||"").toString()){case"open":return"Open";case"in_progress":return"In progress";case"closed":return"Closed";default:return(r||"").toString()||"Open"}}function ro(r){if(!r)return"";try{return new Date(r).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return r}}function no(r){window.location.hash=r}function gs(r,e,t=no,s=void 0){let n=ae("views:detail"),i=null,o=null,l=!1,a=!1,f=!1,u=!1,p=!1,h=!1,m=!1,w="",y="",E=!1,_=null;function P(){return _||(_=document.createElement("dialog"),_.id="delete-confirm-dialog",_.setAttribute("role","alertdialog"),_.setAttribute("aria-modal","true"),document.body.appendChild(_),_)}function I(){if(!i)return;let d=P(),S=i.id,G=i.title||"(no title)";d.innerHTML=`
      <div class="delete-confirm">
        <h2 class="delete-confirm__title">Delete Issue</h2>
        <p class="delete-confirm__message">
          Are you sure you want to delete issue <strong>${S}</strong> \u2014 <strong>${G}</strong>? This action cannot be undone.
        </p>
        <div class="delete-confirm__actions">
          <button type="button" class="btn" id="delete-cancel-btn">Cancel</button>
          <button type="button" class="btn danger" id="delete-confirm-btn">Delete</button>
        </div>
      </div>
    `;let A=d.querySelector("#delete-cancel-btn"),ee=d.querySelector("#delete-confirm-btn");if(A?.addEventListener("click",()=>{typeof d.close=="function"&&d.close(),d.removeAttribute("open")}),ee?.addEventListener("click",async()=>{typeof d.close=="function"&&d.close(),d.removeAttribute("open"),await C()}),d.addEventListener("cancel",me=>{me.preventDefault(),typeof d.close=="function"&&d.close(),d.removeAttribute("open")}),typeof d.showModal=="function")try{d.showModal(),d.setAttribute("open","")}catch{d.setAttribute("open","")}else d.setAttribute("open","")}async function C(){if(!i)return;let d=i.id;try{await e("delete-issue",{id:d}),i=null,o=null,D();let S=vt(window.location.hash||"");t(`#/${S}`)}catch(S){n("delete failed: %o",S),he("Failed to delete issue","error")}}function O(d){d.stopPropagation(),d.preventDefault(),I()}function K(d){let S=vt(window.location.hash||"");return Ye(S,d)}function N(d){Ce(R`
        <div class="panel__body" id="detail-root">
          <p class="muted">${d}</p>
        </div>
      `,r)}function k(){if(!o||!s||typeof s.snapshotFor!="function")return;let d=s.snapshotFor(`detail:${o}`);Array.isArray(d)&&d.length>0&&(i=d.find(G=>String(G.id)===String(o))||d[0])}s&&typeof s.subscribe=="function"&&s.subscribe(()=>{try{k(),D()}catch(d){n("issue stores listener error %o",d)}});let $=()=>{a=!0,D()},L=d=>{d.key==="Enter"?(a=!0,D()):d.key==="Escape"&&(a=!1,D())},B=async()=>{if(!i||l)return;let d=r.querySelector("h2 input"),S=i.title||"",G=d?d.value:"";if(G===S){a=!1,D();return}l=!0,d&&(d.disabled=!0);try{n("save title %s \u2192 %s",String(i.id),G);let A=await e("edit-text",{id:i.id,field:"title",value:G});A&&typeof A=="object"&&(i=A,a=!1,D())}catch(A){n("save title failed %s %o",String(i.id),A),i.title=S,a=!1,D(),he("Failed to save title","error")}finally{l=!1}},te=()=>{a=!1,D()},Y=()=>{m=!0,D()},b=d=>{d.key==="Enter"?(d.preventDefault(),m=!0,D()):d.key==="Escape"&&(d.preventDefault(),m=!1,D())},T=async()=>{if(!i||l)return;let d=r.querySelector("#detail-root .prop.assignee input"),S=i?.assignee??"",G=d?.value??"";if(G===S){m=!1,D();return}l=!0,d&&(d.disabled=!0);try{n("save assignee %s \u2192 %s",String(i.id),G);let A=await e("update-assignee",{id:i.id,assignee:G});A&&typeof A=="object"&&(i=A,m=!1,D())}catch(A){n("save assignee failed %s %o",String(i.id),A),i.assignee=S,m=!1,D(),he("Failed to update assignee","error")}finally{l=!1}},F=()=>{m=!1,D()},Z=d=>{w=d.currentTarget.value||""};function U(d){d.key==="Enter"&&(d.preventDefault(),J())}async function J(){if(!i||l)return;let d=w.trim();if(d){l=!0;try{n("add label %s \u2192 %s",String(i.id),d);let S=await e("label-add",{id:i.id,label:d});S&&typeof S=="object"&&(i=S,w="",D())}catch(S){n("add label failed %s %o",String(i.id),S),he("Failed to add label","error")}finally{l=!1}}}async function ie(d){if(!(!i||l)){l=!0;try{n("remove label %s \u2192 %s",String(i?.id||""),d);let S=await e("label-remove",{id:i.id,label:d});S&&typeof S=="object"&&(i=S,D())}catch(S){n("remove label failed %s %o",String(i?.id||""),S),he("Failed to remove label","error")}finally{l=!1}}}let H=async d=>{if(!i||l){D();return}let S=d.currentTarget,G=i.status||"open",A=S.value;if(A!==G){l=!0,i.status=A,D();try{n("update status %s \u2192 %s",String(i.id),A);let ee=await e("update-status",{id:i.id,status:A});ee&&typeof ee=="object"&&(i=ee,D())}catch(ee){n("update status failed %s %o",String(i.id),ee),i.status=G,D(),he("Failed to update status","error")}finally{l=!1}}},ge=async d=>{if(!i||l){D();return}let S=d.currentTarget,G=typeof i.priority=="number"?i.priority:2,A=Number(S.value);if(A!==G){l=!0,i.priority=A,D();try{n("update priority %s \u2192 %d",String(i.id),A);let ee=await e("update-priority",{id:i.id,priority:A});ee&&typeof ee=="object"&&(i=ee,D())}catch(ee){n("update priority failed %s %o",String(i.id),ee),i.priority=G,D(),he("Failed to update priority","error")}finally{l=!1}}},re=()=>{f=!0,D()},Te=d=>{if(d.key==="Escape")f=!1,D();else if(d.key==="Enter"&&d.ctrlKey){let S=r.querySelector("#detail-root .editable-actions button");S&&S.click()}},X=async()=>{if(!i||l)return;let d=r.querySelector("#detail-root textarea"),S=i.description||"",G=d?d.value:"";if(G===S){f=!1,D();return}l=!0,d&&(d.disabled=!0);try{n("save description %s",String(i?.id||""));let A=await e("edit-text",{id:i.id,field:"description",value:G});A&&typeof A=="object"&&(i=A,f=!1,D())}catch(A){n("save description failed %s %o",String(i?.id||""),A),i.description=S,f=!1,D(),he("Failed to save description","error")}finally{l=!1}},ke=()=>{f=!1,D()},$e=()=>{u=!0,D();try{let d=r.querySelector("#detail-root .design textarea");d&&d.focus()}catch(d){n("focus design textarea failed %o",d)}},_e=d=>{if(d.key==="Escape")u=!1,D();else if(d.key==="Enter"&&(d.ctrlKey||d.metaKey)){let S=r.querySelector("#detail-root .design .editable-actions button");S&&S.click()}},De=async()=>{if(!i||l)return;let d=r.querySelector("#detail-root .design textarea"),S=i.design||"",G=d?d.value:"";if(G===S){u=!1,D();return}l=!0,d&&(d.disabled=!0);try{n("save design %s",String(i?.id||""));let A=await e("edit-text",{id:i.id,field:"design",value:G});A&&typeof A=="object"&&(i=A,u=!1,D())}catch(A){n("save design failed %s %o",String(i?.id||""),A),i.design=S,u=!1,D(),he("Failed to save design","error")}finally{l=!1}},Ie=()=>{u=!1,D()},je=()=>{p=!0,D()},x=d=>{if(d.key==="Escape")p=!1,D();else if(d.key==="Enter"&&(d.ctrlKey||d.metaKey)){let S=r.querySelector("#detail-root .notes .editable-actions button");S&&S.click()}},g=async()=>{if(!i||l)return;let d=r.querySelector("#detail-root .notes textarea"),S=i.notes||"",G=d?d.value:"";if(G===S){p=!1,D();return}l=!0,d&&(d.disabled=!0);try{n("save notes %s",String(i?.id||""));let A=await e("edit-text",{id:i.id,field:"notes",value:G});A&&typeof A=="object"&&(i=A,p=!1,D())}catch(A){n("save notes failed %s %o",String(i?.id||""),A),i.notes=S,p=!1,D(),he("Failed to save notes","error")}finally{l=!1}},j=()=>{p=!1,D()},q=()=>{h=!0,D()},pe=d=>{if(d.key==="Escape")h=!1,D();else if(d.key==="Enter"&&(d.ctrlKey||d.metaKey)){let S=r.querySelector("#detail-root .acceptance .editable-actions button");S&&S.click()}},fe=async()=>{if(!i||l)return;let d=r.querySelector("#detail-root .acceptance textarea"),S=i.acceptance||"",G=d?d.value:"";if(G===S){h=!1,D();return}l=!0,d&&(d.disabled=!0);try{n("save acceptance %s",String(i?.id||""));let A=await e("edit-text",{id:i.id,field:"acceptance",value:G});A&&typeof A=="object"&&(i=A,h=!1,D())}catch(A){n("save acceptance failed %s %o",String(i?.id||""),A),i.acceptance=S,h=!1,D(),he("Failed to save acceptance","error")}finally{l=!1}},Ge=()=>{h=!1,D()},pt=d=>{let S=d.currentTarget,G=y.trim().length>0;y=S.value||"";let A=y.trim().length>0;G!==A&&D()},Je=async()=>{if(!(!i||E||!y.trim())){E=!0,D();try{n("add comment to %s",String(i.id));let d=await e("add-comment",{id:i.id,text:y.trim()});Array.isArray(d)&&(i.comments=d,y="",D())}catch(d){n("add comment failed %s %o",String(i.id),d),he("Failed to add comment","error")}finally{E=!1,D()}}},Wt=d=>{d.key==="Enter"&&(d.ctrlKey||d.metaKey)&&(d.preventDefault(),Je())};function At(d,S){let G=d==="Dependencies"?"add-dependency":"add-dependent";return R`
      <div class="props-card">
        <div>
          <div class="props-card__title">${d}</div>
        </div>
        <ul>
          ${!S||S.length===0?null:S.map(A=>{let ee=A.id,me=K(ee);return R`<li
                  data-href=${me}
                  @click=${()=>t(me)}
                >
                  ${lt(A.issue_type||"")}
                  <span class="text-truncate">${A.title||""}</span>
                  <button
                    aria-label=${`Remove dependency ${ee}`}
                    @click=${et(ee,d)}
                  >
                    
                  </button>
                </li>`})}
        </ul>
        <div class="props-card__footer">
          <input type="text" placeholder="Issue ID" data-testid=${G} />
          <button @click=${We(S,d)}>Add</button>
        </div>
      </div>
    `}function mr(d){let S=a?R`<div class="detail-title">
          <h2>
            <input
              type="text"
              aria-label="Edit title"
              .value=${d.title||""}
              @keydown=${Ke}
            />
            <button @click=${B}>Save</button>
            <button @click=${te}>Cancel</button>
          </h2>
        </div>`:R`<div class="detail-title">
          <h2>
            <span
              class="editable"
              tabindex="0"
              role="button"
              aria-label="Edit title"
              @click=${$}
              @keydown=${L}
              >${d.title||""}</span
            >
          </h2>
        </div>`,G=R`<select
      class=${`badge-select badge--status is-${d.status||"open"}`}
      @change=${H}
      .value=${d.status||"open"}
      ?disabled=${l}
    >
      ${(()=>{let W=String(d.status||"open");return["open","in_progress","closed"].map(de=>R`<option value=${de} ?selected=${W===de}>
              ${ut(de)}
            </option>`)})()}
    </select>`,A=R`<select
      class=${`badge-select badge--priority is-p${String(typeof d.priority=="number"?d.priority:2)}`}
      @change=${ge}
      .value=${String(typeof d.priority=="number"?d.priority:2)}
      ?disabled=${l}
    >
      ${(()=>{let W=String(typeof d.priority=="number"?d.priority:2);return Qe.map((de,tt)=>R`<option value=${String(tt)} ?selected=${W===String(tt)}>
              ${Lt(tt)} ${de}
            </option>`)})()}
    </select>`,ee=f?R`<div class="description">
          <textarea
            @keydown=${Te}
            .value=${d.description||""}
            rows="8"
            style="width:100%"
          ></textarea>
          <div class="editable-actions">
            <button @click=${X}>Save</button>
            <button @click=${ke}>Cancel</button>
          </div>
        </div>`:R`<div
          class="md editable"
          tabindex="0"
          role="button"
          aria-label="Edit description"
          @click=${re}
          @keydown=${Kt}
        >
          ${(()=>{let W=d.description||"";return W.trim()===""?R`<div class="muted">Description</div>`:jt(W)})()}
        </div>`,me=(()=>{let W=d;return String(d.acceptance||W.acceptance_criteria||"")})(),ft=h?R`<div class="acceptance">
          ${me.trim().length>0?R`<div class="props-card__title">Acceptance Criteria</div>`:""}
          <textarea
            @keydown=${pe}
            .value=${me}
            rows="6"
            style="width:100%"
          ></textarea>
          <div class="editable-actions">
            <button @click=${fe}>Save</button>
            <button @click=${Ge}>Cancel</button>
          </div>
        </div>`:R`<div class="acceptance">
          ${(()=>{let W=me,de=W.trim().length>0;return R`${de?R`<div class="props-card__title">Acceptance Criteria</div>`:""}
              <div
                class="md editable"
                tabindex="0"
                role="button"
                aria-label="Edit acceptance criteria"
                @click=${q}
                @keydown=${Vt}
              >
                ${de?jt(W):R`<div class="muted">Add acceptance criteria</div>`}
              </div>`})()}
        </div>`,be=String(d.notes||""),ht=p?R`<div class="notes">
          ${be.trim().length>0?R`<div class="props-card__title">Notes</div>`:""}
          <textarea
            @keydown=${x}
            .value=${be}
            rows="6"
            style="width:100%"
          ></textarea>
          <div class="editable-actions">
            <button @click=${g}>Save</button>
            <button @click=${j}>Cancel</button>
          </div>
        </div>`:R`<div class="notes">
          ${(()=>{let W=be,de=W.trim().length>0;return R`${de?R`<div class="props-card__title">Notes</div>`:""}
              <div
                class="md editable"
                tabindex="0"
                role="button"
                aria-label="Edit notes"
                @click=${je}
                @keydown=${Zt}
              >
                ${de?jt(W):R`<div class="muted">Add notes</div>`}
              </div>`})()}
        </div>`,gt=Array.isArray(d.labels)?d.labels:[],br=R`<div class="props-card labels">
      <div>
        <div class="props-card__title">Labels</div>
      </div>
      <ul>
        ${gt.map(W=>R`<li>
              <span class="badge" title=${W}
                >${W}
                <button
                  class="icon-button"
                  title="Remove label"
                  aria-label=${"Remove label "+W}
                  @click=${()=>ie(W)}
                  style="margin-left:6px"
                >
                  
                </button></span
              >
            </li>`)}
      </ul>
      <div class="props-card__footer">
        <input
          type="text"
          placeholder="Label"
          size="12"
          .value=${w}
          @input=${Z}
          @keydown=${U}
        />
        <button @click=${J}>Add</button>
      </div>
    </div>`,ze=String(d.design||""),yr=u?R`<div class="design">
          ${ze.trim().length>0?R`<div class="props-card__title">Design</div>`:""}
          <textarea
            @keydown=${_e}
            .value=${ze}
            rows="6"
            style="width:100%"
          ></textarea>
          <div class="editable-actions">
            <button @click=${De}>Save</button>
            <button @click=${Ie}>Cancel</button>
          </div>
        </div>`:R`<div class="design">
          ${(()=>{let W=ze,de=W.trim().length>0;return R`${de?R`<div class="props-card__title">Design</div>`:""}
              <div
                class="md editable"
                tabindex="0"
                role="button"
                aria-label="Edit design"
                @click=${$e}
                @keydown=${St}
              >
                ${de?jt(W):R`<div class="muted">Add design</div>`}
              </div>`})()}
        </div>`,Yt=Array.isArray(d.comments)?d.comments:[],ce=R`<div class="comments">
      <div class="props-card__title">Comments</div>
      ${Yt.length===0?R`<div class="muted">No comments yet</div>`:Yt.map(W=>R`
              <div class="comment-item">
                <div class="comment-header">
                  <span class="comment-author">${W.author||"Unknown"}</span>
                  <span class="comment-date"
                    >${ro(W.created_at)}</span
                  >
                </div>
                <div class="comment-text">${W.text}</div>
              </div>
            `)}
      <div class="comment-input">
        <textarea
          placeholder="Add a comment... (Ctrl+Enter to submit)"
          rows="3"
          .value=${y}
          @input=${pt}
          @keydown=${Wt}
          ?disabled=${E}
        ></textarea>
        <button
          @click=${Je}
          ?disabled=${E||!y.trim()}
        >
          ${E?"Adding...":"Add Comment"}
        </button>
      </div>
    </div>`;return R`
      <div class="panel__body" id="detail-root">
        <div class="detail-layout">
          <div class="detail-main">
            ${S} ${ee} ${yr} ${ht}
            ${ft} ${ce}
          </div>
          <div class="detail-side">
            <div class="props-card">
              <div class="props-card__header">
                <div class="props-card__title">Properties</div>
                <button class="delete-issue-btn" title="Delete issue" aria-label="Delete issue" @click=${O}>
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    <line x1="10" y1="11" x2="10" y2="17"></line>
                    <line x1="14" y1="11" x2="14" y2="17"></line>
                  </svg>
                  <span class="tooltip">Delete issue</span>
                </button>
              </div>
                <div class="prop">
                  <div class="label">Type</div>
                  <div class="value">
                    ${lt(d.issue_type)}
                  </div>
                </div>
                <div class="prop">
                  <div class="label">Status</div>
                  <div class="value">${G}</div>
                </div>
                <div class="prop">
                  <div class="label">Priority</div>
                  <div class="value">${A}</div>
                </div>
                <div class="prop assignee">
                  <div class="label">Assignee</div>
                  <div class="value">
                    ${m?R`<input
                              type="text"
                              aria-label="Edit assignee"
                              .value=${d.assignee||""}
                              size=${Math.min(40,Math.max(12,(d.assignee||"").length+3))}
                              @keydown=${W=>{W.key==="Escape"?(W.preventDefault(),F()):W.key==="Enter"&&(W.preventDefault(),T())}}
                            />
                            <button
                              class="btn"
                              style="margin-left:6px"
                              @click=${T}
                            >
                              Save
                            </button>
                            <button
                              class="btn"
                              style="margin-left:6px"
                              @click=${F}
                            >
                              Cancel
                            </button>`:R`${(()=>{let W=d.assignee||"",de=W.trim().length>0;return R`<span
                              class=${de?"editable":"editable muted"}
                              tabindex="0"
                              role="button"
                              aria-label="Edit assignee"
                              @click=${Y}
                              @keydown=${b}
                              >${de?W:"Unassigned"}</span
                            >`})()}`}
                  </div>
                </div>
              </div>
              ${br}
              ${At("Dependencies",d.dependencies||[])}
              ${At("Dependents",d.dependents||[])}
            </div>
          </div>
        </div>
      </div>
    `}function D(){if(!i){N(o?"Loading\u2026":"No issue selected");return}Ce(mr(i),r)}function et(d,S){return async G=>{if(G.stopPropagation(),!(!i||l)){l=!0;try{if(S==="Dependencies"){let A=await e("dep-remove",{a:i.id,b:d,view_id:i.id});A&&typeof A=="object"&&(i=A,D())}else{let A=await e("dep-remove",{a:d,b:i.id,view_id:i.id});A&&typeof A=="object"&&(i=A,D())}}catch(A){n("dep-remove failed %o",A)}finally{l=!1}}}}function We(d,S){return async G=>{if(!i||l)return;let A=G.currentTarget,ee=A.previousElementSibling,me=ee?ee.value.trim():"";if(!me||me===i.id){he("Enter a different issue id");return}if(new Set((d||[]).map(be=>be.id)).has(me)){he("Link already exists");return}l=!0,A&&(A.disabled=!0),ee&&(ee.disabled=!0);try{if(S==="Dependencies"){let be=await e("dep-add",{a:i.id,b:me,view_id:i.id});be&&typeof be=="object"&&(i=be,D())}else{let be=await e("dep-add",{a:me,b:i.id,view_id:i.id});be&&typeof be=="object"&&(i=be,D())}}catch(be){n("dep-add failed %o",be),he("Failed to add dependency","error")}finally{l=!1}}}function Ke(d){d.key==="Escape"?(a=!1,D()):d.key==="Enter"&&(d.preventDefault(),B())}function Kt(d){d.key==="Enter"&&re()}function Vt(d){d.key==="Enter"&&q()}function Zt(d){d.key==="Enter"&&je()}function St(d){d.key==="Enter"&&$e()}return{async load(d){if(!d){N("No issue selected");return}if(o=String(d),i=null,k(),i||N("Loading\u2026"),l=!1,y="",E=!1,D(),i&&!i.comments)try{let S=await e("get-comments",{id:o});Array.isArray(S)&&i&&o===d&&(i.comments=S,D())}catch(S){n("fetch comments failed %s %o",d,S)}},clear(){N("Select an issue to view details")},destroy(){r.replaceChildren(),_&&_.parentNode&&(_.parentNode.removeChild(_),_=null)}}}function hr(r){let e=r.navigate,t=r.onUpdate,s=r.requestRender,n=r.getSelectedId||(()=>null),i=r.row_class||"issue-row",o=new Set;function l(p,h,m,w=""){let y=`${p}:${h}`;return o.has(y)?R`<span>
        <input
          type="text"
          .value=${m}
          class="inline-edit"
          @keydown=${async _=>{if(_.key==="Escape")o.delete(y),s();else if(_.key==="Enter"){let I=_.currentTarget.value||"";I!==m&&await t(p,{[h]:I}),o.delete(y),s()}}}
          @blur=${async _=>{let I=_.currentTarget.value||"";I!==m&&await t(p,{[h]:I}),o.delete(y),s()}}
          autofocus
        />
      </span>`:R`<span
      class="editable text-truncate ${m?"":"muted"}"
      tabindex="0"
      role="button"
      @click=${_=>{_.stopPropagation(),_.preventDefault(),o.add(y),s()}}
      @keydown=${_=>{_.key==="Enter"&&(_.preventDefault(),_.stopPropagation(),o.add(y),s())}}
      >${m||w}</span
    >`}function a(p,h){return async m=>{let y=m.currentTarget.value||"",E={};E[h]=h==="priority"?Number(y):y,await t(p,E)}}function f(p){return h=>{let m=h.target;m&&(m.tagName==="INPUT"||m.tagName==="SELECT")||e(p)}}function u(p){let h=String(p.status||"open"),m=String(p.priority??2),w=n()===p.id;return R`<tr
      role="row"
      class="${i} ${w?"selected":""}"
      data-issue-id=${p.id}
      @click=${f(p.id)}
    >
      <td role="gridcell" class="mono">${Xe(p.id)}</td>
      <td role="gridcell">${lt(p.issue_type)}</td>
      <td role="gridcell">${l(p.id,"title",p.title||"")}</td>
      <td role="gridcell">
        <select
          class="badge-select badge--status is-${h}"
          .value=${h}
          @change=${a(p.id,"status")}
        >
          ${["open","in_progress","closed"].map(y=>R`<option value=${y} ?selected=${h===y}>
                ${ut(y)}
              </option>`)}
        </select>
      </td>
      <td role="gridcell">
        ${l(p.id,"assignee",p.assignee||"","Unassigned")}
      </td>
      <td role="gridcell">
        <select
          class="badge-select badge--priority ${"is-p"+m}"
          .value=${m}
          @change=${a(p.id,"priority")}
        >
          ${Qe.map((y,E)=>R`<option
                value=${String(E)}
                ?selected=${m===String(E)}
              >
                ${Lt(E)} ${y}
              </option>`)}
        </select>
      </td>
    </tr>`}return u}function ms(r,e,t,s=void 0,n=void 0){let i=[],o=new Set,l=new Set,a=new Map,f=n?Ze(n):null;f&&f.subscribe(()=>{let _=i.length===0;if(i=E(),p(),_&&i.length>0){let P=String(i[0].epic?.id||"");P&&!o.has(P)&&y(P)}});let u=hr({navigate:_=>t(_),onUpdate:w,requestRender:p,getSelectedId:()=>null,row_class:"epic-row"});function p(){Ce(h(),r)}function h(){return i.length?R`${i.map(_=>m(_))}`:R`<div class="panel__header muted">No epics found.</div>`}function m(_){let P=_.epic||{},I=String(P.id||""),C=o.has(I),O=f?f.selectEpicChildren(I):[],K=l.has(I);return R`
      <div class="epic-group" data-epic-id=${I}>
        <div
          class="epic-header"
          @click=${()=>y(I)}
          role="button"
          tabindex="0"
          aria-expanded=${C}
        >
          ${Xe(I,{class_name:"mono"})}
          <span class="text-truncate" style="margin-left:8px"
            >${P.title||"(no title)"}</span
          >
          <span
            class="epic-progress"
            style="margin-left:auto; display:flex; align-items:center; gap:8px;"
          >
            <progress
              value=${Number(_.closed_children||0)}
              max=${Math.max(1,Number(_.total_children||0))}
            ></progress>
            <span class="muted mono"
              >${_.closed_children}/${_.total_children}</span
            >
          </span>
        </div>
        ${C?R`<div class="epic-children">
              ${K?R`<div class="muted">Loading</div>`:O.length===0?R`<div class="muted">No issues found</div>`:R`<table class="table">
                      <colgroup>
                        <col style="width: 100px" />
                        <col style="width: 120px" />
                        <col />
                        <col style="width: 120px" />
                        <col style="width: 160px" />
                        <col style="width: 130px" />
                      </colgroup>
                      <thead>
                        <tr>
                          <th>ID</th>
                          <th>Type</th>
                          <th>Title</th>
                          <th>Status</th>
                          <th>Assignee</th>
                          <th>Priority</th>
                        </tr>
                      </thead>
                      <tbody>
                        ${O.map(N=>u(N))}
                      </tbody>
                    </table>`}
            </div>`:null}
      </div>
    `}async function w(_,P){try{await e.updateIssue({id:_,...P}),p()}catch{}}async function y(_){if(o.has(_)){if(o.delete(_),a.has(_)){try{let P=a.get(_);P&&await P()}catch{}a.delete(_);try{n&&n.unregister&&n.unregister(`detail:${_}`)}catch{}}}else{if(o.add(_),l.add(_),p(),s&&typeof s.subscribeList=="function")try{try{n&&n.register&&n.register(`detail:${_}`,{type:"issue-detail",params:{id:_}})}catch{}let P=await s.subscribeList(`detail:${_}`,{type:"issue-detail",params:{id:_}});a.set(_,P)}catch{}l.delete(_)}p()}function E(){let _=n&&n.snapshotFor?n.snapshotFor("tab:epics")||[]:[],P=[];for(let I of _){let C=Array.isArray(I.dependents)?I.dependents:[],O=Number.isFinite(I.total_children),K=Number.isFinite(I.closed_children),N=O?Number(I.total_children)||0:C.length,k=K&&Number(I.closed_children)||0;if(!K)for(let $ of C)String($.status||"")==="closed"&&k++;P.push({epic:I,total_children:N,closed_children:k})}return P}return{async load(){i=E(),p();try{if(i.length>0){let _=String(i[0].epic?.id||"");_&&!o.has(_)&&await y(_)}}catch{}}}}function bs(r){let e=document.createElement("dialog");e.id="fatal-error-dialog",e.setAttribute("role","alertdialog"),e.setAttribute("aria-modal","true"),e.innerHTML=`
    <div class="fatal-error">
      <div class="fatal-error__icon" aria-hidden="true">!</div>
      <div class="fatal-error__body">
        <p class="fatal-error__eyebrow">Critical</p>
        <h2 class="fatal-error__title" id="fatal-error-title">Command failed</h2>
        <p class="fatal-error__message" id="fatal-error-message"></p>
        <pre class="fatal-error__detail" id="fatal-error-detail"></pre>
        <div class="fatal-error__actions">
          <button type="button" class="btn primary" id="fatal-error-reload">Reload</button>
          <button type="button" class="btn" id="fatal-error-close">Dismiss</button>
        </div>
      </div>
    </div>`,r.appendChild(e);let t=e.querySelector("#fatal-error-title"),s=e.querySelector("#fatal-error-message"),n=e.querySelector("#fatal-error-detail"),i=e.querySelector("#fatal-error-reload"),o=e.querySelector("#fatal-error-close"),l=()=>{if(typeof e.close=="function")try{e.close()}catch{}e.removeAttribute("open")},a=(f,u,p="")=>{t&&(t.textContent=f||"Unexpected Error"),s&&(s.textContent=u||"An unrecoverable error occurred.");let h=typeof p=="string"?p.trim():"";if(n&&(h.length>0?(n.textContent=h,n.removeAttribute("hidden")):(n.textContent="No additional diagnostics available.",n.setAttribute("hidden",""))),typeof e.showModal=="function")try{e.showModal(),e.setAttribute("open","")}catch{e.setAttribute("open","")}else e.setAttribute("open","")};return i&&i.addEventListener("click",()=>{window.location.reload()}),o&&o.addEventListener("click",()=>l()),e.addEventListener("cancel",f=>{f.preventDefault(),l()}),{open:a,close:l,getElement(){return e}}}function ys(r,e,t){let s=document.createElement("dialog");s.id="issue-dialog",s.setAttribute("role","dialog"),s.setAttribute("aria-modal","true"),s.innerHTML=`
    <div class="issue-dialog__container" part="container">
      <header class="issue-dialog__header">
        <div class="issue-dialog__title">
          <span class="mono" id="issue-dialog-title"></span>
        </div>
        <button type="button" class="issue-dialog__close" aria-label="Close">\xD7</button>
      </header>
      <div class="issue-dialog__body" id="issue-dialog-body"></div>
    </div>
  `,r.appendChild(s);let n=s.querySelector("#issue-dialog-body"),i=s.querySelector("#issue-dialog-title"),o=s.querySelector(".issue-dialog__close");function l(m){i.replaceChildren(),i.appendChild(Xe(m))}s.addEventListener("mousedown",m=>{m.target===s&&(m.preventDefault(),f())}),s.addEventListener("cancel",m=>{m.preventDefault(),f()}),o.addEventListener("click",()=>f());let a=null;function f(){try{typeof s.close=="function"?s.close():s.removeAttribute("open")}catch{s.removeAttribute("open")}try{t()}catch{}h()}function u(m){try{let w=document.activeElement;w&&w instanceof HTMLElement?a=w:a=null}catch{a=null}l(m);try{"showModal"in s&&typeof s.showModal=="function"?s.showModal():s.setAttribute("open",""),setTimeout(()=>{try{o.focus()}catch{}},0)}catch{s.setAttribute("open","")}}function p(){try{typeof s.close=="function"?s.close():s.removeAttribute("open")}catch{s.removeAttribute("open")}h()}function h(){try{a&&document.contains(a)&&a.focus()}catch{}finally{a=null}}return{open:u,close:p,getMount(){return n}}}var gr=["bug","feature","task","epic","chore"];function Gt(r){switch((r||"").toString().toLowerCase()){case"bug":return"Bug";case"feature":return"Feature";case"task":return"Task";case"epic":return"Epic";case"chore":return"Chore";default:return""}}function ws(r,e,t,s,n=void 0,i=void 0){let o=ae("views:list"),l=[],a="",f=[],u=[],p=s?s.getState().selected_id:null,h=null,m=!1,w=!1;function y(b){return Array.isArray(b)?b:typeof b=="string"&&b!==""&&b!=="all"?[b]:[]}function E(b){return Array.isArray(b)?b:typeof b=="string"&&b!==""?[b]:[]}let _=hr({navigate:b=>{let T=t||(Z=>window.location.hash=Z),F=s?s.getState().view:"issues";T(Ye(F,b))},onUpdate:B,requestRender:L,getSelectedId:()=>p,row_class:"issue-row"}),P=async b=>{l.includes(b)?l=l.filter(T=>T!==b):l=[...l,b],o("status toggle %s -> %o",b,l),s&&s.setState({filters:{status:l}}),await te()},I=b=>{a=b.currentTarget.value,o("search input %s",a),s&&s.setState({filters:{search:a}}),L()},C=b=>{u.includes(b)?u=u.filter(T=>T!==b):u=[...u,b],o("type toggle %s -> %o",b,u),s&&s.setState({filters:{type:u}}),L()},O=b=>{b.stopPropagation(),m=!m,w=!1,L()},K=b=>{b.stopPropagation(),w=!w,m=!1,L()};function N(b,T,F){return b.length===0?`${T}: Any`:b.length===1?`${T}: ${F(b[0])}`:`${T} (${b.length})`}if(s){let b=s.getState();b&&b.filters&&typeof b.filters=="object"&&(l=y(b.filters.status),a=b.filters.search||"",u=E(b.filters.type))}let k=i?Ze(i):null;function $(){let b=f;if(l.length>0&&!l.includes("ready")&&(b=b.filter(T=>l.includes(String(T.status||"")))),a){let T=a.toLowerCase();b=b.filter(F=>{let Z=String(F.id).toLowerCase(),U=String(F.title||"").toLowerCase();return Z.includes(T)||U.includes(T)})}return u.length>0&&(b=b.filter(T=>u.includes(String(T.issue_type||"")))),l.length===1&&l[0]==="closed"&&(b=b.slice().sort(wt)),R`
      <div class="panel__header">
        <div class="filter-dropdown ${m?"is-open":""}">
          <button class="filter-dropdown__trigger" @click=${O}>
            ${N(l,"Status",ut)}
            <span class="filter-dropdown__arrow"></span>
          </button>
          <div class="filter-dropdown__menu">
            ${["ready","open","in_progress","closed"].map(T=>R`
              <label class="filter-dropdown__option">
                <input type="checkbox"
                  .checked=${l.includes(T)}
                  @change=${()=>P(T)}
                />
                ${T==="ready"?"Ready":ut(T)}
              </label>
            `)}
          </div>
        </div>
        <div class="filter-dropdown ${w?"is-open":""}">
          <button class="filter-dropdown__trigger" @click=${K}>
            ${N(u,"Types",Gt)}
            <span class="filter-dropdown__arrow"></span>
          </button>
          <div class="filter-dropdown__menu">
            ${gr.map(T=>R`
              <label class="filter-dropdown__option">
                <input type="checkbox"
                  .checked=${u.includes(T)}
                  @change=${()=>C(T)}
                />
                ${Gt(T)}
              </label>
            `)}
          </div>
        </div>
        <input
          type="search"
          placeholder="Search"
          @input=${I}
          .value=${a}
        />
      </div>
      <div class="panel__body" id="list-root">
        ${b.length===0?R`<div class="issues-block">
              <div class="muted" style="padding:10px 12px;">No issues</div>
            </div>`:R`<div class="issues-block">
              <table
                class="table"
                role="grid"
                aria-rowcount=${String(b.length)}
                aria-colcount="6"
              >
                <colgroup>
                  <col style="width: 100px" />
                  <col style="width: 120px" />
                  <col />
                  <col style="width: 120px" />
                  <col style="width: 160px" />
                  <col style="width: 130px" />
                </colgroup>
                <thead>
                  <tr role="row">
                    <th role="columnheader">ID</th>
                    <th role="columnheader">Type</th>
                    <th role="columnheader">Title</th>
                    <th role="columnheader">Status</th>
                    <th role="columnheader">Assignee</th>
                    <th role="columnheader">Priority</th>
                  </tr>
                </thead>
                <tbody role="rowgroup">
                  ${b.map(T=>_(T))}
                </tbody>
              </table>
            </div>`}
      </div>
    `}function L(){Ce($(),r)}L();async function B(b,T){try{o("updateInline %s %o",b,Object.keys(T)),typeof T.title=="string"&&await e("edit-text",{id:b,field:"title",value:T.title}),typeof T.assignee=="string"&&await e("update-assignee",{id:b,assignee:T.assignee}),typeof T.status=="string"&&await e("update-status",{id:b,status:T.status}),typeof T.priority=="number"&&await e("update-priority",{id:b,priority:T.priority})}catch{}}async function te(){o("load");let b=r.querySelector("#list-root"),T=b?b.scrollTop:0;try{k?f=k.selectIssuesFor("tab:issues"):f=[]}catch(F){o("load failed: %o",F),f=[]}L();try{let F=r.querySelector("#list-root");F&&T>0&&(F.scrollTop=T)}catch{}}r.tabIndex=0,r.addEventListener("keydown",b=>{if(b.key==="ArrowDown"||b.key==="ArrowUp"){let U=b.target;if((U&&typeof U.closest=="function"?U.closest("#list-root table.table"):null)&&!!!(U&&typeof U.closest=="function"&&(U.closest("input")||U.closest("textarea")||U.closest("select")))){let H=U&&typeof U.closest=="function"?U.closest("td"):null;if(H&&H.parentElement){let ge=H.parentElement,re=ge.parentElement;if(re&&re.querySelectorAll){let Te=Array.from(re.querySelectorAll("tr")),X=Math.max(0,Te.indexOf(ge)),ke=H.cellIndex||0,$e=b.key==="ArrowDown"?Math.min(X+1,Te.length-1):Math.max(X-1,0),_e=Te[$e],De=_e&&_e.cells?_e.cells[ke]:null;if(De){let Ie=De.querySelector('button:not([disabled]), [tabindex]:not([tabindex="-1"]), a[href], select:not([disabled]), input:not([disabled]):not([type="hidden"]), textarea:not([disabled])');if(Ie&&typeof Ie.focus=="function"){b.preventDefault(),Ie.focus();return}}}}}}let T=r.querySelector("#list-root tbody"),F=T?T.querySelectorAll("tr"):[];if(F.length===0)return;let Z=0;if(p&&(Z=Array.from(F).findIndex(J=>(J.getAttribute("data-issue-id")||"")===p),Z<0&&(Z=0)),b.key==="ArrowDown"){b.preventDefault();let U=F[Math.min(Z+1,F.length-1)],J=U?U.getAttribute("data-issue-id"):"",ie=J||null;s&&ie&&s.setState({selected_id:ie}),p=ie,L()}else if(b.key==="ArrowUp"){b.preventDefault();let U=F[Math.max(Z-1,0)],J=U?U.getAttribute("data-issue-id"):"",ie=J||null;s&&ie&&s.setState({selected_id:ie}),p=ie,L()}else if(b.key==="Enter"){b.preventDefault();let U=F[Z],J=U?U.getAttribute("data-issue-id"):"";if(J){let ie=t||(ge=>window.location.hash=ge),H=s?s.getState().view:"issues";ie(Ye(H,J))}}});let Y=b=>{b.target.closest(".filter-dropdown")||(m||w)&&(m=!1,w=!1,L())};return document.addEventListener("click",Y),s&&(h=s.subscribe(b=>{if(b.selected_id!==p&&(p=b.selected_id,o("selected %s",p||"(none)"),L()),b.filters&&typeof b.filters=="object"){let T=y(b.filters.status),F=b.filters.search||"",Z=!1;if(JSON.stringify(T)!==JSON.stringify(l)){l=T,te();return}F!==a&&(a=F,Z=!0);let J=E(b.filters.type);JSON.stringify(J)!==JSON.stringify(u)&&(u=J,Z=!0),Z&&L()}})),k&&k.subscribe(()=>{try{f=k.selectIssuesFor("tab:issues"),L()}catch{}}),{load:te,destroy(){r.replaceChildren(),document.removeEventListener("click",Y),h&&(h(),h=null)}}}function ks(r,e,t){let s=ae("views:nav"),n=null;function i(a){return f=>{f.preventDefault(),s("click tab %s",a),t.gotoView(a)}}function o(){let f=e.getState().view||"issues";return R`
      <nav class="header-nav" aria-label="Primary">
        <a
          href="#/issues"
          class="tab ${f==="issues"?"active":""}"
          @click=${i("issues")}
          >Issues</a
        >
        <a
          href="#/epics"
          class="tab ${f==="epics"?"active":""}"
          @click=${i("epics")}
          >Epics</a
        >
        <a
          href="#/board"
          class="tab ${f==="board"?"active":""}"
          @click=${i("board")}
          >Board</a
        >
      </nav>
    `}function l(){Ce(o(),r)}return l(),n=e.subscribe(()=>l()),{destroy(){n&&(n(),n=null),Ce(R``,r)}}}function _s(r,e,t,s){let n=document.createElement("dialog");n.id="new-issue-dialog",n.setAttribute("role","dialog"),n.setAttribute("aria-modal","true"),n.innerHTML=`
    <div class="new-issue__container" part="container">
      <header class="new-issue__header">
        <div class="new-issue__title">New Issue</div>
        <button type="button" class="new-issue__close" aria-label="Close">\xD7</button>
      </header>
      <div class="new-issue__body">
        <form id="new-issue-form" class="new-issue__form">
          <label for="new-title">Title</label>
          <input id="new-title" name="title" type="text" required placeholder="Short summary" />

          <label for="new-type">Type</label>
          <select id="new-type" name="type" aria-label="Issue type"></select>

          <label for="new-priority">Priority</label>
          <select id="new-priority" name="priority" aria-label="Priority"></select>

          <label for="new-labels">Labels</label>
          <input id="new-labels" name="labels" type="text" placeholder="comma,separated" />

          <label for="new-description">Description</label>
          <textarea id="new-description" name="description" rows="6" placeholder="Optional markdown description"></textarea>

          <div aria-live="polite" role="status" class="new-issue__error" id="new-issue-error"></div>

          <div class="new-issue__actions" style="grid-column: 1 / -1">
            <button type="button" id="btn-cancel">Cancel (Esc)</button>
            <button type="submit" id="btn-create">Create</button>
          </div>
        </form>
      </div>
    </div>
  `,r.appendChild(n);let i=n.querySelector("#new-issue-form"),o=n.querySelector("#new-title"),l=n.querySelector("#new-type"),a=n.querySelector("#new-priority"),f=n.querySelector("#new-labels"),u=n.querySelector("#new-description"),p=n.querySelector("#new-issue-error"),h=n.querySelector("#btn-cancel"),m=n.querySelector("#btn-create"),w=n.querySelector(".new-issue__close");function y(){l.replaceChildren();let k=document.createElement("option");k.value="",k.textContent="\u2014 Select \u2014",l.appendChild(k);for(let $ of gr){let L=document.createElement("option");L.value=$,L.textContent=Gt($),l.appendChild(L)}a.replaceChildren();for(let $=0;$<=4;$+=1){let L=document.createElement("option");L.value=String($);let B=Qe[$]||"Medium";L.textContent=`${$} \u2013 ${B}`,a.appendChild(L)}}y();function E(){try{typeof n.close=="function"?n.close():n.removeAttribute("open")}catch{n.removeAttribute("open")}}function _(k){o.disabled=k,l.disabled=k,a.disabled=k,f.disabled=k,u.disabled=k,h.disabled=k,m.disabled=k,m.textContent=k?"Creating\u2026":"Create"}function P(){p.textContent=""}function I(k){p.textContent=k}function C(){try{let k=window.localStorage.getItem("beads-ui.new.type");k?l.value=k:l.value="";let $=window.localStorage.getItem("beads-ui.new.priority");$&&/^\d$/.test($)?a.value=$:a.value="2"}catch{l.value="",a.value="2"}}function O(){let k=l.value||"",$=a.value||"";k.length>0&&window.localStorage.setItem("beads-ui.new.type",k),$.length>0&&window.localStorage.setItem("beads-ui.new.priority",$)}function K(k){let $=/-(\d+)$/.exec(String(k||""));return $&&$[1]?Number($[1]):-1}async function N(){P();let k=String(o.value||"").trim();if(k.length===0){I("Title is required"),o.focus();return}let $=Number(a.value||"2");if(!($>=0&&$<=4)){I("Priority must be 0..4"),a.focus();return}let L=String(l.value||""),B=String(u.value||""),te=String(f.value||"").split(",").map(F=>F.trim()).filter(F=>F.length>0),Y={title:k};L.length>0&&(Y.type=L),String($).length>0&&(Y.priority=$),B.length>0&&(Y.description=B),_(!0);try{await e("create-issue",Y)}catch{_(!1),I("Failed to create issue");return}O();let b=null;try{b=await e("list-issues",{filters:{status:"open",limit:50}})}catch{b=null}let T="";if(Array.isArray(b)){let F=b.filter(Z=>String(Z.title||"")===k);if(F.length>0){let Z=F[0];for(let U of F){let J=K(Z.id||"");K(U.id||"")>J&&(Z=U)}T=String(Z.id||"")}}if(T&&te.length>0)for(let F of te)try{await e("label-add",{id:T,label:F})}catch{}if(T){try{t.gotoIssue(T)}catch{}try{s&&s.setState({selected_id:T})}catch{}}_(!1),E()}return n.addEventListener("cancel",k=>{k.preventDefault(),E()}),w.addEventListener("click",()=>E()),h.addEventListener("click",()=>E()),n.addEventListener("keydown",k=>{k.key==="Enter"&&(k.ctrlKey||k.metaKey)&&(k.preventDefault(),N())}),i.addEventListener("submit",k=>{k.preventDefault(),N()}),{open(){i.reset(),P(),C();try{"showModal"in n&&typeof n.showModal=="function"?n.showModal():n.setAttribute("open","")}catch{n.setAttribute("open","")}setTimeout(()=>{try{o.focus()}catch{}},0)},close(){E()}}}var xs=["list-issues","update-status","edit-text","update-priority","create-issue","list-ready","dep-add","dep-remove","epic-status","update-assignee","label-add","label-remove","subscribe-list","unsubscribe-list","snapshot","upsert","delete","get-comments","add-comment","delete-issue"];function Jr(){let r=Date.now().toString(36),e=Math.random().toString(36).slice(2,8);return`${r}-${e}`}function vs(r,e,t=Jr()){return{id:t,type:r,payload:e}}function As(r={}){let e=ae("ws"),t={initialMs:r.backoff?.initialMs??1e3,maxMs:r.backoff?.maxMs??3e4,factor:r.backoff?.factor??2,jitterRatio:r.backoff?.jitterRatio??.2},s=()=>r.url&&r.url.length>0?r.url:typeof location<"u"?(location.protocol==="https:"?"wss://":"ws://")+location.host+"/ws":"ws://localhost/ws",n=null,i="closed",o=0,l=null,a=!0,f=new Map,u=[],p=new Map,h=new Set;function m(C){for(let O of Array.from(h))try{O(C)}catch{}}function w(){if(!a||l)return;i="reconnecting",e("ws reconnecting\u2026"),m(i);let C=Math.min(t.maxMs||0,(t.initialMs||0)*Math.pow(t.factor||1,o)),O=(t.jitterRatio||0)*C,K=Math.max(0,Math.round(C+(Math.random()*2-1)*O));e("ws retry in %d ms (attempt %d)",K,o+1),l=setTimeout(()=>{l=null,I()},K)}function y(C){try{n?.send(JSON.stringify(C))}catch(O){e("ws send failed",O)}}function E(){for(i="open",e("ws open"),m(i),o=0;u.length;){let C=u.shift();C&&y(C)}}function _(C){let O;try{O=JSON.parse(String(C.data))}catch{e("ws received non-JSON message");return}if(!O||typeof O.id!="string"||typeof O.type!="string"){e("ws received invalid envelope");return}if(f.has(O.id)){let N=f.get(O.id);f.delete(O.id),O.ok?N?.resolve(O.payload):N?.reject(O.error||new Error("ws error"));return}let K=p.get(O.type);if(K&&K.size>0)for(let N of Array.from(K))try{N(O.payload)}catch(k){e("ws event handler error",k)}else e("ws received unhandled message type: %s",O.type)}function P(){i="closed",e("ws closed"),m(i);for(let[C,O]of f.entries())O.reject(new Error("ws disconnected")),f.delete(C);o+=1,w()}function I(){if(!a)return;let C=s();try{n=new WebSocket(C),e("ws connecting %s",C),i="connecting",m(i),n.addEventListener("open",E),n.addEventListener("message",_),n.addEventListener("error",()=>{}),n.addEventListener("close",P)}catch(O){e("ws connect failed %o",O),w()}}return I(),{send(C,O){if(!xs.includes(C))return Promise.reject(new Error(`unknown message type: ${C}`));let K=Jr(),N=vs(C,O,K);return e("send %s id=%s",C,K),new Promise((k,$)=>{f.set(K,{resolve:k,reject:$,type:C}),n&&n.readyState===n.OPEN?y(N):(e("queue %s id=%s (state=%s)",C,K,i),u.push(N))})},on(C,O){p.has(C)||p.set(C,new Set);let K=p.get(C);return K?.add(O),()=>{K?.delete(O)}},onConnection(C){return h.add(C),()=>{h.delete(C)}},close(){a=!1,l&&(clearTimeout(l),l=null);try{n?.close()}catch{}},getState(){return i}}}function so(r){let e=ae("main");e("bootstrap start");let t=R`
    <section id="issues-root" class="route issues">
      <aside id="list-panel" class="panel"></aside>
    </section>
    <section id="epics-root" class="route epics" hidden></section>
    <section id="board-root" class="route board" hidden></section>
    <section id="detail-panel" class="route detail" hidden></section>
  `;Ce(t,r);let s=document.getElementById("top-nav"),n=document.getElementById("issues-root"),i=document.getElementById("epics-root"),o=document.getElementById("board-root"),l=document.getElementById("list-panel"),a=document.getElementById("detail-panel");if(l&&n&&i&&o&&a){let y=function(x,g){let j="Request failed",q="";if(x&&typeof x=="object"){let fe=x;if(typeof fe.message=="string"&&fe.message.length>0&&(j=fe.message),typeof fe.details=="string")q=fe.details;else if(fe.details&&typeof fe.details=="object")try{q=JSON.stringify(fe.details,null,2)}catch{q=""}}else typeof x=="string"&&x.length>0&&(j=x);let pe=g&&g.length>0?`Failed to load ${g}`:"Request failed";w.open(pe,j,q)},_e=function(x){let g=String(x?.status||"all");return g==="ready"?{type:"ready-issues"}:g==="in_progress"?{type:"in-progress-issues"}:g==="closed"?{type:"closed-issues"}:{type:"all-issues"}},Ie=function(x){if(x.view==="issues"){let g=_e(x.filters||{}),j=JSON.stringify(g);try{I.register("tab:issues",g)}catch(q){e("register issues store failed: %o",q)}(!ge||j!==De)&&P.subscribeList("tab:issues",g).then(q=>{ge=q,De=j}).catch(q=>{e("subscribe issues failed: %o",q),y(q,"issues list")})}else if(ge){ge().catch(()=>{}),ge=null,De=null;try{I.unregister("tab:issues")}catch(g){e("unregister issues store failed: %o",g)}}if(x.view==="epics"){try{I.register("tab:epics",{type:"epics"})}catch(g){e("register epics store failed: %o",g)}P.subscribeList("tab:epics",{type:"epics"}).then(g=>{re=g}).catch(g=>{e("subscribe epics failed: %o",g),y(g,"epics")})}else if(re){re().catch(()=>{}),re=null;try{I.unregister("tab:epics")}catch(g){e("unregister epics store failed: %o",g)}}if(x.view==="board"){if(!Te){try{I.register("tab:board:ready",{type:"ready-issues"})}catch(g){e("register board:ready store failed: %o",g)}P.subscribeList("tab:board:ready",{type:"ready-issues"}).then(g=>Te=g).catch(g=>{e("subscribe board ready failed: %o",g),y(g,"board (Ready)")})}if(!X){try{I.register("tab:board:in-progress",{type:"in-progress-issues"})}catch(g){e("register board:in-progress store failed: %o",g)}P.subscribeList("tab:board:in-progress",{type:"in-progress-issues"}).then(g=>X=g).catch(g=>{e("subscribe board in-progress failed: %o",g),y(g,"board (In Progress)")})}if(!ke){try{I.register("tab:board:closed",{type:"closed-issues"})}catch(g){e("register board:closed store failed: %o",g)}P.subscribeList("tab:board:closed",{type:"closed-issues"}).then(g=>ke=g).catch(g=>{e("subscribe board closed failed: %o",g),y(g,"board (Closed)")})}if(!$e){try{I.register("tab:board:blocked",{type:"blocked-issues"})}catch(g){e("register board:blocked store failed: %o",g)}P.subscribeList("tab:board:blocked",{type:"blocked-issues"}).then(g=>$e=g).catch(g=>{e("subscribe board blocked failed: %o",g),y(g,"board (Blocked)")})}}else{if(Te){Te().catch(()=>{}),Te=null;try{I.unregister("tab:board:ready")}catch(g){e("unregister board:ready failed: %o",g)}}if(X){X().catch(()=>{}),X=null;try{I.unregister("tab:board:in-progress")}catch(g){e("unregister board:in-progress failed: %o",g)}}if(ke){ke().catch(()=>{}),ke=null;try{I.unregister("tab:board:closed")}catch(g){e("unregister board:closed failed: %o",g)}}if($e){$e().catch(()=>{}),$e=null;try{I.unregister("tab:board:blocked")}catch(g){e("unregister board:blocked failed: %o",g)}}}};var f=y,u=_e,p=Ie;let h=document.getElementById("header-loading"),m=Dn(h),w=bs(r),E=As(),_=m.wrapSend((x,g)=>E.send(x,g)),P=Cn(_),I=Rn();E.on("snapshot",x=>{let g=x,j=g&&typeof g.id=="string"?g.id:"",q=j?I.getStore(j):null;if(q&&g&&g.type==="snapshot")try{q.applyPush(g)}catch{}}),E.on("upsert",x=>{let g=x,j=g&&typeof g.id=="string"?g.id:"",q=j?I.getStore(j):null;if(q&&g&&g.type==="upsert")try{q.applyPush(g)}catch{}}),E.on("delete",x=>{let g=x,j=g&&typeof g.id=="string"?g.id:"",q=j?I.getStore(j):null;if(q&&g&&g.type==="delete")try{q.applyPush(g)}catch{}});let C=Ze(I),O=!1;if(typeof E.onConnection=="function"){let x=g=>{e("ws state %s",g),g==="reconnecting"||g==="closed"?(O=!0,he("Connection lost. Reconnecting\u2026","error",4e3)):g==="open"&&O&&(O=!1,he("Reconnected","success",2200))};E.onConnection(x)}let K={status:"all",search:"",type:""};try{let x=window.localStorage.getItem("beads-ui.filters");if(x){let g=JSON.parse(x);if(g&&typeof g=="object"){let j=["bug","feature","task","epic","chore"],q="";if(typeof g.type=="string"&&j.includes(g.type))q=g.type;else if(Array.isArray(g.types)){let pe="";for(let fe of g.types)if(j.includes(String(fe))){pe=fe;break}q=pe}K={status:["all","open","in_progress","closed","ready"].includes(g.status)?g.status:"all",search:typeof g.search=="string"?g.search:"",type:q}}}}catch(x){e("filters parse error: %o",x)}let N="issues";try{let x=window.localStorage.getItem("beads-ui.view");(x==="issues"||x==="epics"||x==="board")&&(N=x)}catch(x){e("view parse error: %o",x)}let k={closed_filter:"today"};try{let x=window.localStorage.getItem("beads-ui.board");if(x){let g=JSON.parse(x);if(g&&typeof g=="object"){let j=String(g.closed_filter||"today");(j==="today"||j==="3"||j==="7")&&(k.closed_filter=j)}}}catch(x){e("board prefs parse error: %o",x)}let $=Ln({filters:K,view:N,board:k}),L=In($);L.start();let B=async(x,g)=>{try{return await _(x,g)}catch{return[]}};s&&ks(s,$,L);let te=_s(r,(x,g)=>_(x,g),L,$);try{let x=document.getElementById("new-issue-btn");x&&x.addEventListener("click",()=>te.open())}catch{}let b=ws(l,async(x,g)=>{if(x==="list-issues")try{return C.selectIssuesFor("tab:issues")}catch(j){return e("list selectors failed: %o",j),[]}return B(x,g)},x=>{let g=rr(x);g&&L.gotoIssue(g)},$,P,I);$.subscribe(x=>{let g={status:x.filters.status,search:x.filters.search,type:typeof x.filters.type=="string"?x.filters.type:""};window.localStorage.setItem("beads-ui.filters",JSON.stringify(g))}),$.subscribe(x=>{window.localStorage.setItem("beads-ui.board",JSON.stringify({closed_filter:x.board.closed_filter}))}),b.load();let T=ys(a,$,()=>{let x=$.getState();$.setState({selected_id:null});try{let g=x.view||"issues";L.gotoView(g)}catch{}}),F=null;F=gs(T.getMount(),B,x=>{let g=rr(x);if(g)L.gotoIssue(g);else{let j=vt(x);L.gotoView(j)}},I);let Z=$.getState().selected_id;if(Z){a.hidden=!1,T.open(Z),F&&F.load(Z);let x=`detail:${Z}`,g={type:"issue-detail",params:{id:Z}};try{I.register(x,g)}catch(j){e("register detail store failed: %o",j)}P.subscribeList(x,g).catch(j=>{e("detail subscribe failed: %o",j),y(j,"issue details")})}let U=null;$.subscribe(x=>{let g=x.selected_id;if(g){a.hidden=!1,T.open(g),F&&F.load(g);let j=`detail:${g}`,q={type:"issue-detail",params:{id:g}};try{I.register(j,q)}catch{}P.subscribeList(j,q).then(pe=>{U&&U().catch(()=>{}),U=pe}).catch(pe=>{e("detail subscribe failed: %o",pe),y(pe,"issue details")})}else{try{T.close()}catch{}F&&F.clear(),a.hidden=!0,U&&(U().catch(()=>{}),U=null)}});let J=En(B),ie=ms(i,J,x=>L.gotoIssue(x),P,I),H=Mn(o,J,x=>L.gotoIssue(x),$,P,I),ge=null,re=null,Te=null,X=null,ke=null,$e=null,De=null,je=x=>{n&&i&&o&&a&&(n.hidden=x.view!=="issues",i.hidden=x.view!=="epics",o.hidden=x.view!=="board"),Ie(x),!x.selected_id&&x.view==="epics"&&ie.load(),!x.selected_id&&x.view==="board"&&H.load(),window.localStorage.setItem("beads-ui.view",x.view)};$.subscribe(je),je($.getState()),window.addEventListener("keydown",x=>{let g=x.ctrlKey||x.metaKey,j=String(x.key||"").toLowerCase(),q=x.target,pe=q&&q.tagName?String(q.tagName).toLowerCase():"",fe=pe==="input"||pe==="textarea"||pe==="select"||q&&typeof q.isContentEditable=="boolean"&&q.isContentEditable;g&&j==="n"&&(fe||(x.preventDefault(),te.open()))})}}typeof window<"u"&&typeof document<"u"&&window.addEventListener("DOMContentLoaded",()=>{try{let t=window.localStorage.getItem("beads-ui.theme"),s=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,n=t==="dark"||t==="light"?t:s?"dark":"light";document.documentElement.setAttribute("data-theme",n);let i=document.getElementById("theme-switch");i&&(i.checked=n==="dark")}catch{}let r=document.getElementById("theme-switch");r&&r.addEventListener("change",()=>{let t=r.checked?"dark":"light";document.documentElement.setAttribute("data-theme",t),window.localStorage.setItem("beads-ui.theme",t)});let e=document.getElementById("app");e&&so(e)});export{so as bootstrap};
//# sourceMappingURL=main.bundle.js.map
